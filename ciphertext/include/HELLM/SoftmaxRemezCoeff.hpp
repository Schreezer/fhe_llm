////////////////////////////////////////////////////////////////////////////////
//                                                                            //
// Copyright (C) 2021-2024 Crypto Lab Inc. All rights reserved.               //
//                                                                            //
// This source code is protected under international copyright law.           //
// All rights reserved and protected by the copyright holders.                //
//                                                                            //
////////////////////////////////////////////////////////////////////////////////

#pragma once

#include "HEaaN-math/tools/PolynomialEvaluator.hpp"
#include "HEaaN/HEaaN.hpp"
#include <vector>
namespace HELLM::Softmax {

// input range [-8, 0]
static const HEaaN::Math::ChebyshevCoefficients WC_EXPONENTIAL_15_0(
    {0.20700192122398669790, 0.35750167900487065403, 0.23525300294553806878,
     0.12224867605933258525, 0.051879988856539190900, 0.018488698346254203451,
     0.0056582429909036822727, 0.0015139693735431566342,
     0.00035935018350263406007, 7.6568639532620301934e-5,
     1.4791305605839073455e-5, 2.6121115033526511277e-6,
     4.2469233627865086904e-7, 6.3957470862877483401e-8,
     8.9686029997318186944e-9, 1.1935413088864879233e-9},
    0);

// input range [-8, 0]
static const HEaaN::Math::ChebyshevCoefficients WC_EXPONENTIAL_15_4(
    {2.0700192122e-01, 3.5606427708e-01, 2.2960954229e-01, 1.0376252587e-01,
     5.1879564164e-02, 3.6972172470e-02, 1.1286903371e-02, 2.8748014680e-03,
     3.5935018343e-04, 1.5313489200e-04, 2.9564674006e-05, 5.0963080652e-06,
     8.4938452084e-07, 2.5582988736e-07, 3.5874107990e-08, 4.7741337124e-09},
    4);

// input range [0.00066, 2.00066]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT0B_COEFFS_31_0(
    {2.5265780505880622522,   -3.2478635555877532949,  2.6527249055770207503,
     -2.2883437849048464134,  2.0366007595816829430,   -1.8326728460553479424,
     1.6748915024666168885,   -1.5329109173144475192,  1.4192066091744977179,
     -1.3101927190082962765,  1.2221874327356065992,   -1.1337120575130901545,
     1.0626157570487593133,   -0.98820852623701718021, 0.92913647422862897430,
     -0.86499673347141054205, 0.81495297226776912765,  -0.75865435404104043232,
     0.71566737406774779090,  -0.66556245477624602084, 0.62826396911662653237,
     -0.58317915699119721608, 0.55057861217493432029,  -0.50964441278101363586,
     0.48099921319964630911,  -0.44354948100909633357, 0.41828578821052846109,
     -0.38379461109277267987, 0.36145651552815349135,  -0.32949672827464375393,
     0.30971206463661107361,  -0.27992665667177349718},
    0);

// input range [0.00066, 2.00066]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT0B_COEFFS_31_4(
    {2.4203772466e+00, -2.6718691326e+00, 1.9651791448e+00, -1.4970625710e+00,
     1.1289226164e+00, -8.1353517511e-01, 5.2841585279e-01, -2.6033158086e-01,
     8.1507153520e-01, -1.3828990536e+00, 1.1554399762e+00, -9.4305527737e-01,
     7.4210121651e-01, -5.4964542866e-01, 3.6322083162e-01, -1.8066428327e-01,
     7.0189289315e-01, -7.5842459169e-01, 6.4163549868e-01, -5.2888915357e-01,
     4.1938602841e-01, -3.1240053800e-01, 2.0726121830e-01, -1.0333060796e-01,
     8.5867814633e-01, -1.6172604212e+00, 1.5225018206e+00, -1.4331392223e+00,
     1.3481418724e+00, -1.2676568781e+00, 1.1907302100e+00, -1.1175708305e+00},
    8);

// input range [0.00166, 2.019]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT1_COEFFS_31_0(
    {2.2116163659221405401,   -2.6336224705122923170,  2.0428550729807152151,
     -1.6937622091114556532,  1.4491761459801645326,   -1.2631692830279444212,
     1.1147478607379239180,   -0.99253323599097130275, 0.88964832329251861015,
     -0.80160833031715036577, 0.72531955944499944290,  -0.65855370543868342792,
     0.59964989956375197921,  -0.54733537930351926762, 0.50061218405341089267,
     -0.45868263560590554811, 0.42089864380257243184,  -0.38672621099064389876,
     0.35571995074311528967,  -0.32750439206948971712, 0.30175999519579509109,
     -0.27821251010400360974, 0.25662475237472909641,  -0.23679015699144436665,
     0.21852765973159952611,  -0.20167758318402569680, 0.18609829194511831013,
     -0.17166344264818277480, 0.15825969775715614953,  -0.14578480307779188592,
     0.13414595137990209023,  -0.12325837083878228497},
    0);

// input range [0.00166, 2.019]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT1_COEFFS_31_4(
    {2.2116163659221404,   -2.2123701955770088,  1.3038621265679822,
     -0.6169817737545524,  0.9930265438550515,   -1.4223292900901634,
     0.9199095234450706,   -0.45207495896247907, 0.6711206635609192,
     -0.9857234974208888,  0.6476051475199496,   -0.3210204162013005,
     0.5957798087359139,   -0.8793239489361182,  0.5795689332411824,
     -0.28782569846104655, 0.4208986438025724,   -0.45671053268888595,
     0.30209507786720485,  -0.15034104307175405, 0.2870005948772779,
     -0.4261962698232833,  0.2821058417184431,   -0.14045029522967467,
     0.43705531946319903,  -0.3136768493809737,  0.20780936226086488,
     -0.10351455828156364, 0.6330387910286246,   -1.166278424622335,
     1.0731676110392168,   -0.9860669667102583},
    4);

// input range [0.00275, 1.38]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT2_COEFFS_15_0(
    {2.4326263135414828368, -2.7039735150851431931, 1.9978406930872649366,
     -1.5867992114519814656, 1.3039211487130785909, -1.0930107558485173150,
     0.92822093428114651519, -0.79545050293112877697, 0.68612046096430475750,
     -0.59459943260729412325, 0.51697715812702060067, -0.45041744470491028133,
     0.39278908065614776266, -0.34244161961413500752, 0.29806163462194461249,
     -0.25857583280059871418},
    0);

// input range [0.00275, 1.38]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT2_COEFFS_15_4(
    {2.4323703573e+00, -2.2445000046e+00, 1.2885044831e+00, -6.0174830517e-01,
     9.1110522090e-01, -1.2851478501e+00, 8.2246147785e-01, -4.0168930551e-01,
     6.8562060569e-01, -6.7197295228e-01, 4.3778231273e-01, -2.1592728803e-01,
     7.8461376260e-01, -1.3681191988e+00, 1.1903745778e+00, -1.0327213555e+00},
    4);

// input range [0.00212, 1.695]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT3_COEFFS_15_0(
    {2.3032374793661108969, -2.6544084204221655719, 2.0124264836028616763,
     -1.6351101796013594666, 1.3724086365801955041, -1.1739702666703165169,
     1.0167163910026834202, -0.88809808792862915508, 0.78050239042399358078,
     -0.68894224828862982274, 0.60995821480479077710, -0.54104029843586396170,
     0.48029892639179766235, -0.42626547465364521147, 0.37776457075620627361,
     -0.33382802513963348292},
    0);

// input range [0.00212, 1.695]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT3_COEFFS_15_4(
    {2.3028469372e+00, -2.1213538118e+00, 1.2278568392e+00, -5.7589050712e-01,
     8.9206744754e-01, -1.2657983580e+00, 8.1347494328e-01, -3.9829122064e-01,
     7.7974159384e-01, -7.1011883188e-01, 4.6431518528e-01, -2.2951359482e-01,
     9.5913037187e-01, -1.7024983868e+00, 1.5082062020e+00, -1.3328426825e+00},
    4);

// input range [0.0015, 2.145]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT4A_COEFFS_255_0(
    {2.1819524654701227714,     -2.6273387461401953115,
     2.0533862459978696036,     -1.7136129516417905861,
     1.4750291790400929072,     -1.2931341052817926756,
     1.1476014900140130435,     -1.0274237267651808332,
     0.92595386069684836270,    -0.83886105486429952277,
     0.76316043477148967174,    -0.69670388169214140757,
     0.63789155444081774880,    -0.58549835162645980959,
     0.53856433037425581136,    -0.49632268232107486400,
     0.45815077290792007026,    -0.42353588824262897623,
     0.39205066910116868634,    -0.36333510654543002825,
     0.33708309235557757962,    -0.31303220041275936005,
     0.29095580452087797410,    -0.27065691521564877578,
     0.25196330110709068572,    -0.23472358372858240164,
     0.21880407970390018528,    -0.20408622336899904866,
     0.19046444512625196314,    -0.17784441117685254782,
     0.16614155245275480423,    -0.15527982696205572496,
     0.14519067201729290017,    -0.13581211207569048061,
     0.12708799498527380625,    -0.11896733487075392612,
     0.11140374411795753088,    -0.10435494022327110472,
     0.097782315883864318861,   -0.091650562777548626952,
     0.085927341139325502091,   -0.080582988576486337076,
     0.075590262645107992176,   -0.070924112591230381885,
     0.066561476381012883246,   -0.062481099737671790509,
     0.058663374393957887471,   -0.055090193176968437476,
     0.051744819882727203802,   -0.048611772183559275706,
     0.045676716051710189170,   -0.042926370385848496889,
     0.040348420699458116052,   -0.037931440876873009645,
     0.035664822128071449391,   -0.033538708380800335692,
     0.031543937440993864216,   -0.029671987332138624868,
     0.027914927293168329406,   -0.026265372974266366389,
     0.024716445421965315379,   -0.023261733490291267490,
     0.021895259354357943312,   -0.020611446837572166213,
     0.019405092294145216348,   -0.018271337815487822337,
     0.017205646552787899875,   -0.016203779969045514290,
     0.015261776852424431818,   -0.014375933939278709744,
     0.013542788009887838139,   -0.012759099333010459242,
     0.012021836347039321293,   -0.011328161475977328519,
     0.010675417987802432295,   -0.010061117811174663414,
     0.0094829302339724482535,  -0.0089386714139240321109,
     0.0084262946377077914914,  -0.0079438812704064472678,
     0.0074896323421796543573,  -0.0070618607235242784720,
     0.0066589838445722222567,  -0.0062795169175763700403,
     0.0059220666250953731198,  -0.0055853252394423924814,
     0.0052680651417424191005,  -0.0049691337114748256462,
     0.0046874485596867672671,  -0.0044219930811706857577,
     0.0041718123028248835629,  -0.0039360090071772608866,
     0.0037137401116643667617,  -0.0035042132857348066599,
     0.0033066837892002494584,  -0.0031204515164999917756,
     0.0029448582326863476332,  -0.0027792849879871134113,
     0.0026231496987661962016,  -0.0024759048835915751035,
     0.0023370355439377649844,  -0.0022060571798039092132,
     0.0020825139312240100487,  -0.0019659768372875695903,
     0.0018560422048815582921,  -0.0017523300799122373061,
     0.0016544828142716494589,  -0.0015621637222819412851,
     0.0014750558207841635472,  -0.0013928606474396263055,
     0.0013152971521838172036,  -0.0012421006571176661910,
     0.0011730218804406930568,  -0.0011078260203272601112,
     0.0010462918949225598251,  -0.00098821113489073471228,
     0.00093338742518515613914, -0.00088163579293175787047,
     0.00083278193852169374278, -0.00078666160720062870172,
     0.00074311999861974644424, -0.00070201121197904732197,
     0.00066319772454762100728, -0.00062654990148914223321,
     0.00059194553505462184695, -0.00055926941132915678576,
     0.00052841290283571391503, -0.00049927358540745626044,
     0.00047175487784133225996, -0.00044576570294011322976,
     0.00042122016863825643945, -0.00039803726798933051987,
     0.00037614059686967308434, -0.00035545808832483396728,
     0.00033592176255254013983, -0.00031746749157872334127,
     0.00030003477774187838936, -0.00028356654515594689091,
     0.00026800894337330550627, -0.00025331116251751936306,
     0.00023942525920052190990, -0.00022630599258100890595,
     0.00021391066996027821684, -0.00020219900134868699265,
     0.00019113296247049951033, -0.00018067666570731678292,
     0.00017079623851065657393, -0.00016145970884272339196,
     0.00015263689723109687034, -0.00014429931504808962303,
     0.00013642006864899027177, -0.00012897376902541457896,
     0.00012193644665063140437, -0.00011528547121309811361,
     0.00010899947595261380454, -0.00010305828633055452915,
     9.7442852781663734400e-5,  -9.2135187309899869720e-5,
     8.7118303704953559030e-5,  -8.2376161169296871388e-5,
     7.7893611158071201664e-5,  -7.3656347245808701046e-5,
     6.9650857844962386531e-5,  -6.5864381611536242662e-5,
     6.2284865382800175001e-5,  -5.8900924501184278028e-5,
     5.5701805387008743243e-5,  -5.2677350230753734280e-5,
     4.9817963683139404148e-5,  -4.7114581428399610289e-5,
     4.4558640532821591365e-5,  -4.2142051466913936613e-5,
     3.9857171705480987199e-5,  -3.7696780815446202926e-5,
     3.5654056946501412051e-5,  -3.3722554644583297444e-5,
     3.1896183912811762847e-5,  -3.0169190448884597259e-5,
     2.8536136992025643200e-5,  -2.6991885716444977436e-5,
     2.5531581611903970518e-5,  -2.4150636795399143826e-5,
     2.2844715701199287000e-5,  -2.1609721099502343168e-5,
     2.0441780896833384341e-5,  -1.9337235673993163144e-5,
     1.8292626919898170430e-5,  -1.7304685922037175076e-5,
     1.6370323276514627528e-5,  -1.5486618982766294799e-5,
     1.4650813090024784334e-5,  -1.3860296864489462100e-5,
     1.3112604447923491799e-5,  -1.2405404980066721215e-5,
     1.1736495158822935914e-5,  -1.1103792213659245397e-5,
     1.0505327269049377951e-5,  -9.9392390761064346902e-6,
     9.4037680917888881981e-6,  -8.8972508862307235743e-6,
     8.4181148598467626336e-6,  -7.9648732529012912149e-6,
     7.5361204312057982782e-6,  -7.1305274325333887850e-6,
     6.7468377592065003916e-6,  -6.3838634031339943823e-6,
     6.0404810903463808168e-6,  -5.7156287328065834925e-6,
     5.4083020759607992901e-6,  -5.1175515311420560516e-6,
     4.8424791825502796100e-6,  -4.5822359591091677085e-6,
     4.3360189620439355096e-6,  -4.1030689395369262627e-6,
     3.8826679003019434561e-6,  -3.6741368583746258205e-6,
     3.4768337018468249402e-6,  -3.2901511786792364122e-6,
     3.1135149931098728019e-6,  -2.9463820065376623509e-6,
     2.7882385371017475559e-6,  -2.6385987524991066647e-6,
     2.4970031508870256584e-6,  -2.3630171250037417137e-6,
     2.2362296049112349923e-6,  -2.1162517750195811667e-6,
     2.0027158612933566528e-6,  -1.8952739847681265537e-6,
     1.7935970777198093169e-6,  -1.6973738590324254107e-6,
     1.6063098655010816202e-6,  -1.5201265359876603760e-6,
     1.4385603455171804657e-6,  -1.3613619865637423772e-6,
     1.2882955949269064866e-6,  -1.2191380177427825837e-6,
     1.1536781213095130115e-6,  -1.0917161365346597798e-6,
     1.0330630399326834166e-6,  -9.7753996821462870407e-7,
     9.2497766461968759471e-7,  -8.7521595523984867123e-7,
     8.2810325368470129435e-7,  -7.8349609252395768617e-7,
     7.4125868003068610767e-7,  -7.0126248082889443521e-7,
     6.6338581912523114448e-7,  -6.2751350327643010555e-7,
     5.9353647051195248513e-7,  -5.6135145069529573131e-7,
     5.3086064806785560804e-7,  -5.0197143997624003959e-7,
     4.7459609163772923440e-7,  -4.4865148604933056499e-7,
     4.2405886819375422554e-7,  -4.0074360274079243287e-7},
    0);

// input range [0.0015, 2.145]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT4A_COEFFS_255_16(
    {2.181952465470123,       -2.605125425606005,      2.0088310487942387,
     -1.646456535660242,      1.3848788077353889,      -1.1794590656722765,
     1.0097267879819314,      -0.8645218783688721,     0.7370345341006141,
     -0.622758238302888,      0.5185167056513209,      -0.42195122209099256,
     0.3312279869615726,      -0.24485943946807498,    0.16158827097882977,
     -0.08030728635657924,    0.41288628358990087,     -0.7488330985093857,
     0.6777398659946119,      -0.6117358330514897,     0.5501691776904846,
     -0.4924725810663848,     0.4381471600073246,      -0.3867498044663876,
     0.3378830461577885,      -0.29118683068108386,    0.2463317341346599,
     -0.20301328268615637,    0.16094711640975856,     -0.11986479767741587,
     0.07951010658212923,     -0.03963569598830319,    0.14232147116615973,
     -0.26084277995068506,    0.2383118758625328,      -0.21692802203972655,
     0.19657793413518104,     -0.1771561625535098,     0.15856412745864948,
     -0.14070925782302818,    0.123504217899257,       -0.10686620711382383,
     0.09071632148091818,     -0.07497896631850831,    0.05958131139864514,
     -0.04445278074142796,    0.02952457011449107,     -0.014729185963377397,
     0.0885633508447688,      -0.16276937789947563,    0.1490916682796163,
     -0.1360332279769511,     0.12353710083735348,     -0.11154937270024484,
     0.10001885094215601,     -0.08889676701067845,    0.07813649903996613,
     -0.06769331193566372,    0.05752411256843439,     -0.047587217927334356,
     0.0378421342621934,      -0.02824934539205945,    0.018770108478004977,
     -0.009366255655875066,   0.019391979689697292,    -0.03570816658743924,
     0.03276560293841275,     -0.029944963997762655,   0.02723547807167501,
     -0.024626856501979284,   0.022109246757612763,    -0.01967318802414136,
     0.01730956901498384,     -0.015009587747347081,   0.012764713042731815,
     -0.010566647526446794,   0.008407291913078173,    -0.006278710375467681,
     0.004173096803601849,    -0.002082741767019289,   0.012951694480593298,
     -0.02386685670987738,    0.021915315495810238,    -0.02004167679265608,
     0.0182391621193473,      -0.016501275122966508,   0.014821775022347753,
     -0.013194651276638415,   0.011614099351090803,    -0.010074497459461844,
     0.008570384168665915,    -0.007096436756810889,   0.00564745022050186,
     -0.004218316831366382,   0.002804006145176178,    -0.0013995453697454672,
     0.005733929243056553,    -0.010573603777401894,   0.00971535464345514,
     -0.008890150211767395,   0.00809515101188461,     -0.007327628321236186,
     0.006584953973105261,    -0.00586459058269659,    0.005164082149412236,
     -0.004481044995368564,   0.003813159001897084,    -0.0031581591072784524,
     0.0025138270302737294,   -0.0018779831851487086,  0.0012484787548435162,
     -0.0006231878897271048,  0.003927555671880774,    -0.007245016151828585,
     0.006659049799698253,    -0.006095241138477807,   0.005551697327877074,
     -0.005026597043313909,   0.004518183961187106,    -0.004024760496357454,
     0.0035446817670229443,   -0.0030763497632025913,  0.002618207695960647,
     -0.0021687345053144663,  0.0017264395054795907,   -0.00128985714671861,
     0.0008575418735796594,   -0.00042806305973874456, 0.00047175487784133224,
     -0.0008698869763589547,  0.000799840117378552,    -0.0007323833185361591,
     0.0006672967518246491,   -0.000604368600124103,   0.0005433943347662983,
     -0.00048417601943045926, 0.00042652163782111636,  -0.0003702444426744871,
     0.00031516232372528607,  -0.0002610971923417097,  0.00020787438060288686,
     -0.0001553220526506446,  0.00010327062619628301,  -5.155220210341648e-05,
     0.0003274402059380577,   -0.0006043764905026436,  0.000555806390827091,
     -0.0005090137913994067,  0.0004638482654654013,   -0.0004201647780118794,
     0.00037782320168617487,  -0.0003366878498753035,  0.0002966270252952866,
     -0.0002575125825001438,  0.00021921950277285543,  -0.00018162547990750193,
     0.00014461051543298198,  -0.00010805652186437846, 7.18469325983394e-05,
     -3.586631709388935e-05,  0.00015131476310631994,  -0.0002793537529455289,
     0.00025695814705149403,  -0.00023537182435972036, 0.0002145265233529327,
     -0.00019435638259486347, 0.00017479772626315834,  -0.00015578885705724822,
     0.00013726985577722385,  -0.00011918238689369572, 0.00010146950945010463,
     -8.407549265804504e-05,  6.69456355629583e-05,    -5.00260901721042e-05,
     3.3263687449087466e-05,  -1.6605765589452912e-05, 0.00010595152734740387,
     -0.0001956284937286241,  0.0001799652472134341,   -0.00016486417850648786,
     0.00015027795082157977,  -0.00013616087490292604, 0.00012246876215994793,
     -0.00010915878277280842, 9.618932829589298e-05,   -8.351987830209952e-05,
     7.111087062487425e-05,   -5.892357476744592e-05,  4.6919968059722e-05,
     -3.50626141528564e-05,   2.3314543449614778e-05,  -1.1639135075381925e-05,
     2.6225208895846985e-05,  -4.703158410936708e-05,  4.327259600414205e-05,
     -3.9647263839515734e-05, 3.614435887211884e-05,   -3.275303795449983e-05,
     2.946280926444896e-05,   -2.6263499171375403e-05, 2.3145220132020664e-05,
     -2.0098339511255914e-05, 1.711344922682212e-05,   -1.4181336119641402e-05,
     1.1292952953765567e-05,  -8.439389952142115e-06,  5.611846776176334e-06,
     -2.8016048585572283e-06, 1.7933297645364447e-05,  -3.312009250341942e-05,
     3.0475329140940772e-05,  -2.792415858059606e-05,  2.545872672587538e-05,
     -2.307144737435315e-05,  2.07549784430003e-05,    -1.8502198974487067e-05,
     1.630618685063716e-05,   -1.416019714153261e-05,  1.205764102087033e-05,
     -9.992065180041894e-06,  7.957131675055505e-06,   -5.946598141847842e-06,
     3.954298316749355e-06,   -1.974122799873282e-06,  8.94491841964494e-06,
     -1.3724065378230312e-05, 1.2629255944796817e-05,  -1.1572979989750367e-05,
     1.0552007888656642e-05,  -9.563219352449483e-06,  8.603593739465808e-06,
     -7.670200682338917e-06,  6.7601910000418236e-06,  -5.870787866298497e-06,
     4.999278206413403e-06,   -4.143004295311105e-06,  3.2993555302306153e-06,
     -2.4657603520856176e-06, 1.6396782899838568e-06,  -8.185921037982404e-07,
     7.399821316957501e-06,   -1.4003455283837579e-05, 1.3249652058955221e-05,
     -1.2535937480383322e-05, 1.1860138880490978e-05,  -1.122019969326231e-05,
     1.0614173106003699e-05,  -1.0040216052422882e-05, 9.49658352819124e-06,
     -8.981623211124733e-06,  8.49377036908569e-06,    -8.031543039619841e-06,
     7.593537466203668e-06,   -7.1784237767892895e-06, 6.784941891100067e-06,
     -6.411897643852679e-06},
    16);

// input range [0.0015, 2.145]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT4B_COEFFS_31_0(
    {2.1802927001676407022,   -2.6240123734731116084,  2.0500393104971158040,
     -1.7102316222893557682,  1.4715994400544329377,   -1.2896416800562994848,
     1.1440317628622593048,   -1.0237616617923245503,  0.92218391707436420719,
     -0.83496709773160574166, 0.75912564092175507125,  -0.69251063911893906884,
     0.63352135472529181015,  -0.58093167402876119520, 0.53378051635507825132,
     -0.49129979905538031335, 0.45286546415872346124,  -0.41796321073230390254,
     0.38616391224412248512,  -0.35710559308054104028, 0.33047995702882210215,
     -0.30602214339676234012, 0.28350281570225646741,  -0.26272196481244073812,
     0.24350399127150239364,  -0.22569375481225703687, 0.20915336367274544814,
     -0.19375953539988495809, 0.17940140263145121003,  -0.16597866729743301362,
     0.15340002832709969427,  -0.14158182366395128042},
    0);

// input range [0.0015, 2.145]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT4B_COEFFS_31_4(
    {2.180292700167641,   -2.1832711874251816,  1.289767104089045,
     -0.6110332251094646, 0.9891566397265121,   -1.4187872978684757,
     0.9185111479400309,  -0.45164554812180535, 0.6786799258028617,
     -0.997817089192177,  0.6560124422170855,   -0.3253248295479131,
     0.6060827953929394,  -0.8953043237928808,  0.5904664164438231,
     -0.2933463532923055, 0.4528654641587235,   -0.47870635413633783,
     0.3168288637750235,  -0.1577286355724613,  0.3021571087947418,
     -0.4490504319875094, 0.29739780811804417,  -0.14811284000073488,
     0.4870079825430048,  -0.33644772459322303, 0.223013341382583,
     -0.1111234724098078, 0.7176056105258048,   -1.3278293383794642,
     1.2272002266167976,  -1.1326545893116102},
    4);

// input range [0.0015, 2.145]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT4C_COEFFS_63_0(
    {2.1819290456356495130,   -2.6272918261209955520,
     2.0533390846297872194,   -1.7135653870305721547,
     1.4749810477945873375,   -1.2930852419063686257,
     1.1475517262920985383,   -1.0273728911313106083,
     0.92590177759454527426,  -0.83880754408704320861,
     0.76310531078393804713,  -0.69664695292866791296,
     0.63783262257830884965,  -0.58543721082818225323,
     0.53850076650145063993,  -0.49625647210876409741,
     0.45808168310122110222,  -0.42346367468965971130,
     0.39197507579839176314,  -0.36325586463102541959,
     0.33699991904614753412,  -0.31294479787835593402,
     0.29086385869299894156,  -0.27056009452246987926,
     0.25186125512978809165,  -0.23461594177214561910,
     0.21869044927533900627,  -0.20396618855530428445,
     0.19033756486387445433,  -0.17771021740381319198,
     0.16599954813378469959,  -0.15512948397638387989,
     0.14503142889784252507,  -0.13564337158750610603,
     0.12690912152997193445,  -0.11877765170266022337,
     0.11120253035635320499,  -0.10414142764380834989,
     0.097555685470712413976, -0.091409941016183730311,
     0.085671796028061897615, -0.080311525332846333146,
     0.075301819080921040033, -0.070617554127915846464,
     0.066235590673808882675, -0.062134590874594865152,
     0.058294856631981362118, -0.054698184174253203473,
     0.051327733381684248739, -0.048167910095019848459,
     0.045204259885471627246, -0.042423371967288495216,
     0.039812792105695887745, -0.037360943519020627839,
     0.035057054898369301562, -0.032891094774760275073,
     0.030853711554959958085, -0.028936178625777981366,
     0.027130343994161957357, -0.025428583988696570945,
     0.023823760598377425995, -0.022309182067895872450,
     0.020878566406048553702, -0.019526007496029790584},
    0);

// input range [0.0015, 2.145]
static const HEaaN::Math::ChebyshevCoefficients WC_INVERSE_SQRT4C_COEFFS_63_8(
    {2.1819290456356497,   -2.50895663473775,     1.8337538041703576,
     -1.3904310741570602,  1.0447667505884144,    -0.7508731313469689,
     0.486800402219819,    -0.2395628316269114,   0.7288586069378591,
     -1.2313357602453188,  1.0249724325469818,    -0.8339175313184144,
     0.6545110042005486,   -0.48378513020892633,  0.31923257489913726,
     -0.15864614299667545, 0.4067539497195369,    -0.6985587562530575,
     0.5891795851251953,   -0.4843774161105552,   0.38325858772963484,
     -0.2850049656778883,  0.18885455161490267,   -0.09408513686732328,
     0.33237891820345233,  -0.5728240030238476,   0.4845390552185064,
     -0.3992990436459838,  0.316540138030085,     -0.23573026280461185,
     0.15636170641525104,  -0.07794444955551105,  0.1450314288978425,
     -0.21917418002448594, 0.1858799167548273,    -0.15351450145491596,
     0.12191194237972557,  -0.09091246609243311,  0.06036115458799743,
     -0.03010666366463939, 0.10963616894620387,   -0.18968172223234422,
     0.16097905673020696,  -0.13302644243558087,  0.10569119427245197,
     -0.07884487562922549, 0.05236238698603893,   -0.026121096316933434,
     0.1026554667633685,   -0.11456761039596022,  0.0973027739176923,
     -0.08045675959757048, 0.06395612602927385,   -0.04772943812129622,
     0.031706843616829364, -0.015819664595929164, 0.12341484621983984,
     -0.23148942900622385, 0.21704275195329567,   -0.20342867190957256,
     0.19059008478701941,  -0.178473456543167,    0.16702853124838843,
     -0.15620805996823833},
    8);

static const HEaaN::Math::ChebyshevCoefficients EXPONENTIALB =
    WC_EXPONENTIAL_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT0B_COEFFS =
    WC_INVERSE_SQRT0B_COEFFS_31_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT1_COEFFS =
    WC_INVERSE_SQRT1_COEFFS_31_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT2_COEFFS =
    WC_INVERSE_SQRT2_COEFFS_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT3_COEFFS =
    WC_INVERSE_SQRT3_COEFFS_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT4_COEFFS =
    WC_INVERSE_SQRT4A_COEFFS_255_16;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT4B_COEFFS =
    WC_INVERSE_SQRT4B_COEFFS_31_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT4C_COEFFS =
    WC_INVERSE_SQRT4C_COEFFS_63_8;

////////////////////////
///////softmax2/////////
////////////////////////

// input range [-2, 0]
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL4_14_0(
    {0.20700192122398669790, 0.35750167900487065403, 0.23525300294553806878,
     0.12224867605933258525, 0.051879988856539190900, 0.018488698346254203451,
     0.0056582429909036822727, 0.0015139693735431566342,
     0.00035935018350263406007, 7.6568639532620301934E-5,
     1.4791305605839073455E-5, 2.6121115033526511277E-6,
     4.2469233627865086904E-7, 6.3957470862877483401E-8},
    0);

// input range [0.08, 257]
static const HEaaN::Math::ChebyshevCoefficients
    INVERSE_31_0({0.19645773133681095172,  -0.37743384227253540350,
                  0.36209283321575008519,  -0.34703518178104683207,
                  0.33212448319119520155,  -0.31748675642060775106,
                  0.30300903119455774775,  -0.28878635524893144680,
                  0.27474418682362365964,  -0.26093065613666105348,
                  0.24732676899966514135,  -0.23391521820264968520,
                  0.22075273245898102221,  -0.20773447051332602118,
                  0.19501720331340502880,  -0.18238169592648022930,
                  0.17011452491527161867,  -0.15784900857644258407,
                  0.14603831566692645436,  -0.13412732303730867190,
                  0.12278154090808640435,  -0.11120631263965001360,
                  0.10033660162270940370,  -0.089074353724686575566,
                  0.078695443463202744717, -0.067718451761845701721,
                  0.057849690534371867380, -0.047124144185695022378,
                  0.037790809563190365235, -0.027275373469717446579,
                  0.018510311566803593061, -0.0081543222761249308639},
                 0);

// input range [0.003, 1.01]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT2_15_0(
    {2.9562430808741480075, -3.3556731197293917601, 2.5223627417697469038,
     -2.0069215021041696906, 1.6647742179168583889, -1.3787238633679705805,
     1.1759676087242277503, -0.97859451558714461506, 0.84583532423633852348,
     -0.69435240357184739759, 0.60707675263978991020, -0.48153918825712884525,
     0.42931230305226303818, -0.31740449651658215605, 0.29609572775569833442,
     -0.18815881482884792535},
    0);

// input range [0.0025, 1.5]
static const HEaaN::Math::ChebyshevCoefficients
    INVERSE_SQRT4_31_0({1.4071060293924556003,   -0.80312433749287638767,
                        0.51592195718352844276,  -0.38549721825213436787,
                        0.30737596233577200999,  -0.25406462258282040384,
                        0.21480444510624915590,  -0.18441486550472563834,
                        0.16005449158792512428,  -0.14001804252735989986,
                        0.12321194071825523470,  -0.10889820882929000716,
                        0.096558248624279881879, -0.085815386254561575889,
                        0.076388404663832553487, -0.068062409325816037876,
                        0.060669876066111704940, -0.054077932911246924709,
                        0.048179597930461177990, -0.042887609281572369987,
                        0.038130006778385141198, -0.033846937496125996977,
                        0.029988357371934921161, -0.026512443777742560651,
                        0.023384666510446142225, -0.020577650860205779904,
                        0.018072360110818007300, -0.015862225964448553256,
                        0.013965699926914179519, -0.012470155329832682559,
                        0.011750529266950349538, -0.015251874785978205134},
                       0);

// input range [0.003, 1.2]
static const HEaaN::Math::ChebyshevCoefficients
    INVERSE_SQRT8_31_0({1.1834319252461612429,    -0.31026817993521725571,
                        0.17318958354054166703,   -0.11958628192780992258,
                        0.090230991107528811287,  -0.071455722385750683330,
                        0.058316566187274240543,  -0.048566112186949444211,
                        0.041026960546405154327,  -0.035019015707475414363,
                        0.030120255838755433236,  -0.026053993194271423673,
                        0.022630725426277389230,  -0.019715957490398058076,
                        0.017211359947336189353,  -0.015043212018517534700,
                        0.013155032150515183843,  -0.011502721369592645082,
                        0.010051270959438460321,  -0.0087724756931881958422,
                        0.0076433122051530451458, -0.0066447693468793500386,
                        0.0057609946109407726240, -0.0049786703276343602380,
                        0.0042865693059333907712, -0.0036752745469787206160,
                        0.0031371042349660684875, -0.0026664322658852678485,
                        0.0022611439942857697434, -0.0019287565793785465388,
                        0.0017241039796933388302, -0.0027278645899714209271},
                       0);

// input range [0, 1.07]
static const HEaaN::Math::ChebyshevCoefficients
    INVERSE_SQRT16_95_0({1.0904311470749101674,     -0.13944273866063191715,
                         0.073593634217156913705,   -0.049780008013900038517,
                         0.037310819503798615558,   -0.029581656554433466526,
                         0.024298342817797485194,   -0.020448120888362125635,
                         0.017512636954511463531,   -0.015198264264658326443,
                         0.013325858059351392228,   -0.011779727911442597092,
                         0.010481723213456885825,   -0.0093770866663003013324,
                         0.0084262709297607081507,  -0.0075999738869199809422,
                         0.0068760041038261158244,  -0.0062372336032889472324,
                         0.0056702212142982686335,  -0.0051642630554655020746,
                         0.0047107228662175708124,  -0.0043025502964166540412,
                         0.0039339282507219661582,  -0.0036000106068139840254,
                         0.0032967243516565540151,  -0.0030206183763131272523,
                         0.0027687465616466051140,  -0.0025385764026291624468,
                         0.0023279168858757687590,  -0.0021348610453260908227,
                         0.0019577398242947441697,  -0.0017950847302257411019,
                         0.0016455973881529888182,  -0.0015081245515753088452,
                         0.0013816374637835357816,  -0.0012652147120885095069,
                         0.0011580279052266266630,  -0.0010593296469283782950,
                         0.00096844338796961790142, -0.00088475482344954121142,
                         0.00080770456771295344643, -0.00073678189078046803233,
                         0.00067151934071895837701, -0.00061148810857743271225,
                         0.00055629401821285416030, -0.00050557404396302578848,
                         0.00045899327577842820886, -0.00041624226493841234920,
                         0.00037703469449615615438, -0.00034110532762426944451,
                         0.00030820819446227946531, -0.00027811498420782850442,
                         0.00025061361428983189375, -0.00022550695270837965567,
                         0.00020261167317792139761, -0.00018175722569163547226,
                         0.00016278490763603948611, -0.00014554702270689555936,
                         0.00012990611667612975892, -0.00011573428058850385829,
                         0.00010291251327009586115, -9.1330136144375112841E-5,
                         8.0884254305580198593E-5,  -7.1479258617872859622E-5,
                         6.3026364312822440726E-5,  -5.5443182164236804611E-5,
                         4.8653318842467903383E-5,  -4.2586003502058490612E-5,
                         3.7175738047043649646E-5,  -3.2361968855895040866E-5,
                         2.8088778040217509105E-5,  -2.4304592564018128269E-5,
                         2.0961909768907862755E-5,  -1.8017038039453837147E-5,
                         1.5429851505932369723E-5,  -1.3163557822265329066E-5,
                         1.1184478177833926866E-5,  -9.4618388056570316216E-6,
                         7.9675733382811256397E-6,  -6.6761354385781650337E-6,
                         5.5643211971945298751E-6,  -4.6111008431889117105E-6,
                         3.7974593609034823415E-6,  -3.1062456458318250525E-6,
                         2.5220298669646572317E-6,  -2.0309687354530470615E-6,
                         1.6206784143753718591E-6,  -1.2801148531574699449E-6,
                         9.9946142222319533071E-7,  -7.7002394607580989407E-7,
                         5.8413388080206202216E-7,  -4.3506261711565622331E-7,
                         3.1695937126426537738E-7,  -2.2487951764718131749E-7,
                         1.5550699305036391547E-7,  -1.5214901124104418118E-7},
                        0);

// Softmax2
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL4 =
    EXPONENTIAL4_14_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_1 = INVERSE_31_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT2 =
    INVERSE_SQRT2_15_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT4 =
    INVERSE_SQRT4_31_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT8 =
    INVERSE_SQRT8_31_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT16 =
    INVERSE_SQRT16_95_0;

////////////////////////
///////softmaxR/////////
////////////////////////

// input range [-4, 0], precision 7.5e-9
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_R_10_4(
    {3.0850832255e-01, 4.3047859926e-01, 1.8604502905e-01, 5.4922923091e-02,
     1.3730730773e-02, 5.3190443656e-03, 8.6607511438e-04, 1.1995847230e-04,
     7.4974038862e-06, 1.6479241794e-06, 1.6454729066e-07},
    4);

// input range [0.04, 129], precision 2.1e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R0_31_4(
    {3.0305119383e-01, -3.0163276920e-01, 1.7980693406e-01, -8.5564310131e-02,
     1.4149570986e-01, -2.0399229563e-01, 1.3252589822e-01, -6.5298437610e-02,
     1.0247394304e-01, -1.5117839820e-01, 9.9633214567e-02, -4.9481041818e-02,
     9.3405599649e-02, -1.3838617489e-01, 9.1459936118e-02, -4.5494863071e-02,
     8.9925675442e-02, -8.3067228297e-02, 5.5085391093e-02, -2.7455867273e-02,
     5.3222277279e-02, -7.9301642195e-02, 5.2617717709e-02, -2.6234271419e-02,
     1.1096494068e-01, -6.3694708783e-02, 4.2294453695e-02, -2.1096994720e-02,
     1.7496297553e-01, -3.2939377026e-01, 3.0974705969e-01, -2.9104433020e-01},
    4);

// input range [0.04, 129], precision 4.3e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R0_15_4(
    {2.9738600212e-01, -2.6478815789e-01, 1.5535211677e-01, -7.3368779676e-02,
     1.1775331132e-01, -1.6858343782e-01, 1.0901606472e-01, -5.3572361916e-02,
     1.4531235143e-01, -1.0739037262e-01, 7.0584768543e-02, -3.4999331197e-02,
     2.0508099893e-01, -3.7671775516e-01, 3.4553823474e-01, -3.1650992360e-01},
    4);

// input range [0.005, 1.19], precision 6.6e-2
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R1_15_4(
    {2.4067368841e+00, -2.1868381690e+00, 1.2307243099e+00, -5.6869225426e-01,
     8.1310098416e-01, -1.1291192528e+00, 7.1460549717e-01, -3.4668857302e-01,
     4.6154742806e-01, -5.0460905873e-01, 3.2551134844e-01, -1.5959572079e-01,
     4.5084578757e-01, -7.5616923725e-01, 6.3274089127e-01, -5.2748922686e-01},
    4);

// input range [0.004, 1.3], precision 9.3e-2
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R2_15_4(
    {2.3881761225e+00, -2.1908981109e+00, 1.2447850101e+00, -5.7814587084e-01,
     8.4985287870e-01, -1.1892603521e+00, 7.5681668463e-01, -3.6838331809e-01,
     5.4635890421e-01, -5.7185422442e-01, 3.7070769135e-01, -1.8229667774e-01,
     5.7443798124e-01, -9.8099068520e-01, 8.3584330900e-01, -7.0977087929e-01},
    4);

// input range [0.004, 1.43], precision 1.03e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R3_15_4(
    {2.3018577137e+00, -2.1159107609e+00, 1.2052304492e+00, -5.6053309629e-01,
     8.3001105507e-01, -1.1638070566e+00, 7.4166819493e-01, -3.6131639660e-01,
     5.5321687572e-01, -5.7097055274e-01, 3.7060023410e-01, -1.8238213685e-01,
     5.9354455625e-01, -1.0186687402e+00, 8.7228965402e-01, -7.4450558339e-01},
    4);

// input range [0.004, 1.49], precision 1.54e-2
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R4_31_4(
    {2.2679492541e+00, -2.1887656830e+00, 1.2570917662e+00, -5.8705286543e-01,
     8.8355286724e-01, -1.2440615771e+00, 7.9506102974e-01, -3.8796592747e-01,
     4.9810312983e-01, -7.2204927642e-01, 4.6994518113e-01, -2.3164587877e-01,
     4.0882397358e-01, -5.9637474558e-01, 3.8978614332e-01, -1.9259843049e-01,
     1.8148498805e-01, -2.3180127112e-01, 1.5209854429e-01, -7.5327749795e-02,
     1.3717285319e-01, -2.0153179008e-01, 1.3237350934e-01, -6.5598611627e-02,
     1.3052633237e-01, -1.2297776071e-01, 8.0865514109e-02, -4.0099923227e-02,
     1.5800901715e-01, -2.7832185690e-01, 2.4470680158e-01, -2.1473188566e-01},
    4);

// input range [0.004, 1.49], precision 1.07e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R4_15_4(
    {2.2654995428e+00, -2.0840076057e+00, 1.1882983518e+00, -5.5296577635e-01,
     8.2126717964e-01, -1.1524819302e+00, 7.3487481120e-01, -3.5813065571e-01,
     5.5582344119e-01, -5.7015749336e-01, 3.7026155504e-01, -1.8227161624e-01,
     6.0138867743e-01, -1.0342694509e+00, 8.8749275907e-01, -7.5909336152e-01},
    4);

// SoftmaxR
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_R =
    EXPONENTIAL_R_10_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R0 =
    INVERSE_SQRT_R0_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R1 =
    INVERSE_SQRT_R1_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R2 =
    INVERSE_SQRT_R2_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R3 =
    INVERSE_SQRT_R3_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_R4 =
    INVERSE_SQRT_R4_15_4;

////////////////////////
///////softmaxW/////////
////////////////////////

// input range [-8, 0]
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_UNI_15_0(
    {0.20700192122398669790, 0.35750167900487065403, 0.23525300294553806878,
     0.12224867605933258525, 0.051879988856539190900, 0.018488698346254203451,
     0.0056582429909036822727, 0.0015139693735431566342,
     0.00035935018350263406007, 7.6568639532620301934E-5,
     1.4791305605839073455E-5, 2.6121115033526511277E-6,
     4.2469233627865086904E-7, 6.3957470862877483401E-8,
     8.9686029997318186944E-9, 1.1935413088864879233E-9},
    0);

// input range [0, 1]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI_FIRST_63_0(
    {3.7470305990772725077,   -4.9506126504226601429,  4.0991823631504159518,
     -3.5933950798309905966,  3.2273832378594492653,   -2.9484777847915468059,
     2.7150739779141806297,   -2.5238037680302781465,  2.3524062240436780925,
     -2.2078469443926949338,  2.0724157181004327084,   -1.9570490147527785976,
     1.8451102578125388071,   -1.7498386349147899964,  1.6544506980999222304,
     -1.5739447496483508862,  1.4908498817136441139,   -1.4217127458423934085,
     1.3481192516317991152,   -1.2880402006037047017,  1.2220323857102685106,
     -1.1693498916617200398,  1.1095760022370454465,   -1.0630313726565410169,
     1.0085279816063103209,   -0.96711597255892982063, 0.91720465396199358988,
     -0.88007735212516353875, 0.83430157334634015213,  -0.80070404244081480038,
     0.75878850689461159380,  -0.72801568925038767184, 0.68983690187463648032,
     -0.66120740676382186578, 0.62676703606614009243,  -0.59961339930458826808,
     0.56900686036591937461,  -0.54268476907955039531, 0.51605729140473793138,
     -0.48997851361767579648, 0.46746050682506173022,  -0.44115566784630891357,
     0.42276935601675097276,  -0.39598643800430621348, 0.38151798174120738867,
     -0.35435869161872558612, 0.34319698194233791963,  -0.31628253102764996785,
     0.30724217507748143039,  -0.28187643999223228829, 0.27305627710398247757,
     -0.25130716200643098075, 0.24010084320408496108,  -0.22463188440152096689,
     0.20812705124626858821,  -0.20145063033263794688, 0.17766705483557199249,
     -0.18020789278204280088, 0.15099684501694528747,  -0.15686756857900238551,
     0.13392952756288747065,  -0.12249547590423905511, 0.13904088892264107336,
     -0.058973465693983131323},
    0);

// input range [0, 1.25]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_31_0(
    {3.0156373527268628403,   -3.7537713146827050737,  2.9949682888400310489,
     -2.5401245489856283281,  2.2157061577048145889,   -1.9638690591379921904,
     1.7583211500133947957,   -1.5849058388175968189,  1.4351299036405005570,
     -1.3034984976823949192,  1.1862527890786173387,   -1.0807087306823568473,
     0.98488332776515245061,  -0.89727040564940750177, 0.81669943391885776758,
     -0.74224304008903892146, 0.67315436640601981174,  -0.60882341903450149751,
     0.54874589937987654559,  -0.49250047084335633383, 0.43973186722968043796,
     -0.39013813501328403541, 0.34346085803319567328,  -0.29947757174576484980,
     0.25799581079136947613,  -0.21884839313268033896, 0.18188965360600111314,
     -0.14699241633339871183, 0.11404554989924641215,  -0.082951988645557474642,
     0.053627132451242878263, -0.025997559102497339091},
    0);

// input range [0, 2]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_15_0(
    {2.0849554494127793219, -2.3878925317206353254, 1.7726000719960649577,
     -1.4344154304482324825, 1.1657801268495513241, -0.99072053109011917608,
     0.81938891062960278530, -0.70865066592350363937, 0.58475471329540269142,
     -0.50901713297399273600, 0.41412878486195213203, -0.36058584557771915489,
     0.28579496855561627086, -0.24756292473801517247, 0.18778878689249837879,
     -0.16061514563776653194},
    0);

// input range [0, 1.25]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_LAST_31_0(
    {3.0156373510978229771,   -3.7537713114066646080,  2.9949682855159705639,
     -2.5401245455997675702,  2.2157061542663334982,   -1.9638690556803674601,
     1.7583211465901691504,   -1.5849058354932494216,  1.4351299004777661049,
     -1.3034984947288604458,  1.1862527863555311679,   -1.0807087281786614542,
     0.98488332543819078561,  -0.89727040343052174691, 0.81669943172196973856,
     -0.74224303782221731652, 0.67315436398733007294,  -0.60882341640650765342,
     0.54874589651927638334,  -0.49250046776969852792, 0.43973186401570567980,
     -0.39013813178332255841, 0.34346085492202682026,  -0.29947756883417397515,
     0.25799580806844730600,  -0.21884839052066649565, 0.18188965103362891933,
     -0.14699241381010897349, 0.11404554756327442571,  -0.082951986757057495907,
     0.053627131297109805836, -0.025997558772950339843},
    0);

// input range [0, 2]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_LAST_63_0(
    {2.1979900834528169992,     -2.6051677309437894061,
     1.9979706766751611552,     -1.6503746651773885873,
     1.3890634205138122627,     -1.2040649335332927763,
     1.0392233596683410292,     -0.91811768860287310701,
     0.79982774872165808493,    -0.71340439047902579194,
     0.62320492372701736924,    -0.55878281855168658795,
     0.48775420401283370488,    -0.43859565331075444878,
     0.38168215804062603338,    -0.34371342667256600351,
     0.29771316290270250184,    -0.26823749967173204856,
     0.23094569450319906402,    -0.20805585536396932407,
     0.17785198525916121306,    -0.16013212800722769508,
     0.13576316619336630547,    -0.12212506646348613389,
     0.10258445193222721592,    -0.092171542423323831439,
     0.076628405007078041825,   -0.068756276594447107747,
     0.056512459194784415510,   -0.050629915711638155953,
     0.041092906664853216870,   -0.036755044164563024003,
     0.029420179446757288874,   -0.026268728879277870926,
     0.020706806567949042764,   -0.018455010853719987104,
     0.014303024823444402794,   -0.012723464748028990386,
     0.0096770896641796585194,  -0.0085915357718508587117,
     0.0063985648634997417400,  -0.0056693223400387872379,
     0.0041236192358878540442,  -0.0036460612152769633613,
     0.0025818160934036192223,  -0.0022779310362374972290,
     0.0015641542274118136920,  -0.0013770026104724603402,
     0.00091227268117451985402, -0.00080128070960125101536,
     0.00050880658447479859219, -0.00044583525952433862272,
     0.00026890557485346688699, -0.00023503237546445452136,
     0.00013291938779206588336, -0.00011586380991658035844,
     6.0231231244540997788E-5,  -5.2348836716731756352E-5,
     2.4188849614237725133E-5,  -2.0953907555049508261E-5,
     8.0529701701573912246E-6,  -6.9485195123939744024E-6,
     1.8578602507931104411E-6,  -1.5944129637970908636E-6},
    0);

static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_UNI_15 =
    EXPONENTIAL_UNI_15_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI_FIRST_63 =
    INVERSE_SQRT_UNI_FIRST_63_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_31 =
    INVERSE_SQRT_UNI32768_31_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_15 =
    INVERSE_SQRT_UNI32768_15_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_LAST_31 =
    INVERSE_SQRT_UNI32768_LAST_31_0;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI32768_LAST_63 =
    INVERSE_SQRT_UNI32768_LAST_63_0;

////////////////////////
///////softmaxFL////////
////////////////////////

// input range [-4, 0], precision 7.5e-9
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_FL_10_4(
    {3.0850832255e-01, 4.3047859926e-01, 1.8604502905e-01, 5.4922923091e-02,
     1.3730730773e-02, 5.3190443656e-03, 8.6607511438e-04, 1.1995847230e-04,
     7.4974038862e-06, 1.6479241794e-06, 1.6454729066e-07},
    4);

// input range [10.7, 32001], precision 4.54e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_ZERO_63_8(
    {1.9172859562e-02, -2.2556182712e-02, 1.6756311902e-02, -1.2846484481e-02,
     9.7301923415e-03, -7.0334045840e-03, 4.5777144999e-03, -2.2579146085e-03,
     7.1979212274e-03, -1.2243530846e-02, 1.0251340104e-02, -8.3814452461e-03,
     6.6045171113e-03, -4.8968148382e-03, 3.2383218165e-03, -1.6114339540e-03,
     4.5885988220e-03, -7.9225509797e-03, 6.7129999395e-03, -5.5405403669e-03,
     4.3979646259e-03, -3.2786534511e-03, 2.1764297014e-03, -1.0854341865e-03,
     3.9785456106e-03, -6.8893722373e-03, 5.8517660570e-03, -4.8393248317e-03,
     3.8474192290e-03, -2.8716685563e-03, 1.9078702211e-03, -9.5197309815e-04,
     2.3497528023e-03, -3.2226538102e-03, 2.7440123511e-03, -2.2738987287e-03,
     1.8108098268e-03, -1.3532872667e-03, 8.9990618993e-04, -4.4927009702e-04,
     1.6941673622e-03, -2.9439625090e-03, 2.5080392340e-03, -2.0792776898e-03,
     1.6564203803e-03, -1.2382452526e-03, 8.2356342058e-04, -4.1120777560e-04,
     2.1552056075e-03, -2.0295658024e-03, 1.7301375954e-03, -1.4351214899e-03,
     1.1437531009e-03, -8.5529125164e-04, 5.6899710016e-04, -2.8414010045e-04,
     2.9397183473e-03, -5.6018182083e-03, 5.3354930324e-03, -5.0808489417e-03,
     4.8362069690e-03, -4.6020205664e-03, 4.3766684596e-03, -4.1606600179e-03},
    8);

// input range [0.00002, 1.13], precision 6.50e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_31_4(
    {3.8755292091e+00, -3.5544069925e+00, 2.1430652079e+00, -1.0254142725e+00,
     1.7382311050e+00, -2.5204344836e+00, 1.6438135562e+00, -8.1177299459e-01,
     1.3334791668e+00, -1.9740402844e+00, 1.3041247858e+00, -6.4860343161e-01,
     1.2403210111e+00, -1.8428661058e+00, 1.2204295706e+00, -6.0781024853e-01,
     2.0734412309e+00, -1.3031006421e+00, 8.6572484083e-01, -4.3197380003e-01,
     8.4667292027e-01, -1.2645730461e+00, 8.4049869233e-01, -4.1948503235e-01,
     3.1484466734e+00, -1.1175710264e+00, 7.4326246859e-01, -3.7110169626e-01,
     5.5100831950e+00, -1.0655203444e+01, 1.0296366687e+01, -9.9478185554e+00},
    4);

// input range [0.1, 3], precision 1.02e-3
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_15_4(
    {1.1410998564e+00, -8.2708423401e-01, 3.9910543014e-01, -1.6836664696e-01,
     1.5693879943e-01, -1.8748730521e-01, 1.0585840052e-01, -4.7805834618e-02,
     2.7013489358e-02, -3.2389826053e-02, 1.8768493611e-02, -8.6026920864e-03,
     1.0171684606e-02, -1.3502137956e-02, 8.9546623370e-03, -5.9095048100e-03},
    4);

// input range [0.1, 3], precision 1.02e-3
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_47_8(
    {1.1411003887e+00, -8.5163131916e-01, 4.5246615247e-01, -2.6239797891e-01,
     1.5712819993e-01, -9.3864606970e-02, 5.3000672904e-02, -2.3936069923e-02,
     2.6973033865e-02, -3.5223523775e-02, 2.3066953164e-02, -1.5087737646e-02,
     9.7779735936e-03, -6.1662301182e-03, 3.6098569184e-03, -1.6648545105e-03,
     1.0140682005e-03, -1.3584855214e-03, 9.0890066008e-04, -6.0528567947e-04,
     3.9815537239e-04, -2.5408912980e-04, 1.5005937915e-04, -6.9582288460e-05,
     8.6686863907e-05, -1.1719308960e-04, 7.9049668888e-05, -5.3023665177e-05,
     3.5096184595e-05, -2.2512163130e-05, 1.3346659090e-05, -6.2038280430e-06,
     1.9670159985e-06, -2.6659404144e-06, 1.8060056537e-06, -1.2161236752e-06,
     8.0770313676e-07, -5.1957632431e-07, 3.0870971972e-07, -1.4369244534e-07,
     1.8374644576e-07, -2.5094291713e-07, 1.7139368735e-07, -1.1708210773e-07,
     7.9978595900e-08, -5.4619080935e-08, 3.7262334464e-08, -2.5363843015e-08},
    8);

static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_FL_10 =
    EXPONENTIAL_FL_10_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_ZERO_63 =
    INVERSE_SQRT_FL_ZERO_63_8;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_31 =
    INVERSE_SQRT_FL_31_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_15 =
    INVERSE_SQRT_FL_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FL_47 =
    INVERSE_SQRT_FL_47_8;

////////////////////////
///////softmaxFT////////
////////////////////////

// input range [-4, 0], precision 7.5e-9
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_FT_10_4(
    {3.0850832255e-01, 4.3047859926e-01, 1.8604502905e-01, 5.4922923091e-02,
     1.3730730773e-02, 5.3190443656e-03, 8.6607511438e-04, 1.1995847230e-04,
     7.4974038862e-06, 1.6479241794e-06, 1.6454729066e-07},
    4);

// input range [0.17, 513], precision 2.3e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT0_28_4(
    {1.5090679392e-01, -1.6743493629e-01, 1.0758814404e-01, -6.1622211440e-02,
     7.0847213252e-02, -1.0212399514e-01, 6.6338656632e-02, -3.2684453014e-02,
     5.1191573521e-02, -7.5510956900e-02, 4.9759843524e-02, -2.4710636123e-02,
     4.6617610902e-02, -6.9057207584e-02, 4.5635627692e-02, -2.2699210600e-02,
     4.3235025025e-02, -7.4420428706e-02, 6.2746080614e-02, -5.1339315443e-02,
     2.6782894729e-02, -3.9897525616e-02, 2.6467985627e-02, -1.3195204869e-02,
     5.2022902070e-02, -9.7623263905e-02, 9.1559212036e-02, -8.5775105017e-02,
     8.0285234310e-02},
    4);

// input range [0.001, 1.22], precision 1.04e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT1_28_4(
    {2.8449204338e+00, -3.0025431721e+00, 1.8461023104e+00, -9.7563967549e-01,
     1.2823705521e+00, -1.8370214957e+00, 1.1882275714e+00, -5.8396727026e-01,
     8.6753590402e-01, -1.2742906218e+00, 8.3722491562e-01, -4.1502548351e-01,
     7.7039324725e-01, -1.1370880276e+00, 7.4948636146e-01, -3.7221680663e-01,
     5.3908174359e-01, -8.9744370205e-01, 7.2414179137e-01, -5.5625854342e-01,
     3.7700450923e-01, -5.5982588209e-01, 3.7054400203e-01, -1.8447665316e-01,
     5.5200377152e-01, -1.0152080121e+00, 9.3297201022e-01, -8.5618882457e-01,
     7.8468143554e-01},
    4);

// input range [0.001, 1.52], precision 1.28e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT2_28_4(
    {2.6041038966e+00, -2.7838491107e+00, 1.7302687059e+00, -9.3253527790e-01,
     1.1906941930e+00, -1.7089184571e+00, 1.1068053986e+00, -5.4436678977e-01,
     8.2190834857e-01, -1.2088644080e+00, 7.9498253916e-01, -3.9430546495e-01,
     7.3565810562e-01, -1.0870654007e+00, 7.1710225171e-01, -3.5630897451e-01,
     5.5416019258e-01, -9.3089987018e-01, 7.6023161875e-01, -5.9448263081e-01,
     3.7711831595e-01, -5.6056431204e-01, 3.7130276951e-01, -1.8493525763e-01,
     5.9429239133e-01, -1.0992798311e+00, 1.0161058754e+00, -9.3797023351e-01,
     8.6479776615e-01},
    4);

// input range [0.001, 1.62], precision 1.36e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT3_28_4(
    {2.5378902477e+00, -2.7229477661e+00, 1.6977340544e+00, -9.2025324773e-01,
     1.1645469598e+00, -1.6722195495e+00, 1.0834053881e+00, -5.3296414872e-01,
     8.0810496898e-01, -1.1889673102e+00, 7.8208632247e-01, -3.8796487269e-01,
     7.2477713889e-01, -1.0713025541e+00, 7.0685271254e-01, -3.5126056327e-01,
     5.5739670535e-01, -9.3868274241e-01, 7.6913609538e-01, -6.0436594853e-01,
     3.7620175991e-01, -5.5934716125e-01, 3.7056540119e-01, -1.8458860190e-01,
     6.0525853476e-01, -1.1213028962e+00, 1.0380876076e+00, -9.5978409479e-01,
     8.8634547311e-01},
    4);

// input range [0.001, 1.67], precision 1.40e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT4_28_4(
    {2.5068473133e+00, -2.6942767430e+00, 1.6823721494e+00, -9.1442190738e-01,
     1.1521520155e+00, -1.6547996873e+00, 1.0722876580e+00, -5.2754350329e-01,
     8.0144834441e-01, -1.1793579237e+00, 7.7585135310e-01, -3.8489736241e-01,
     7.1947920493e-01, -1.0636154113e+00, 7.0184840729e-01, -3.4879392157e-01,
     5.5876340231e-01, -9.4209187418e-01, 7.7313206960e-01, -6.0888114217e-01,
     3.7562410121e-01, -5.5855470723e-01, 3.7007187970e-01, -1.8435218697e-01,
     6.1027411697e-01, -1.1314126736e+00, 1.0482122423e+00, -9.6986254457e-01,
     8.9632993660e-01},
    4);

// input range [0.001, 1.70], precision 1.40e-1
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT5_28_4(
    {2.4888263792e+00, -2.6775975196e+00, 1.6734217262e+00, -9.1101428709e-01,
     1.1449169634e+00, -1.6446249194e+00, 1.0657908917e+00, -5.2437500870e-01,
     7.9753001006e-01, -1.1736974711e+00, 7.7217671369e-01, -3.8308892526e-01,
     7.1634620400e-01, -1.0590660646e+00, 6.9888514186e-01, -3.4733281698e-01,
     5.5951100793e-01, -9.4399759983e-01, 7.7539653033e-01, -6.1146489157e-01,
     3.7524470080e-01, -5.5802860276e-01, 3.6974134484e-01, -1.8419292889e-01,
     6.1314600078e-01, -1.1372128334e+00, 1.0540312653e+00, -9.7566450763e-01,
     9.0208659704e-01},
    4);

// SoftmaxFT
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_FT =
    EXPONENTIAL_FT_10_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT0 =
    INVERSE_SQRT_FT0_28_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT1 =
    INVERSE_SQRT_FT1_28_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT2 =
    INVERSE_SQRT_FT2_28_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT3 =
    INVERSE_SQRT_FT3_28_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT4 =
    INVERSE_SQRT_FT4_28_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_FT5 =
    INVERSE_SQRT_FT5_28_4;

////////////////
///// BERT /////
////////////////

// input range [-8 , 0]
static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_UNI_15_4(
    {0.2070019212239867, 0.3560642770773188, 0.22960954229163724,
     0.10376252586711088, 0.05187956416420291, 0.0369721724695017,
     0.011286903370595685, 0.0028748014680210726, 0.0003593501835026341,
     0.00015313489198262283, 2.9564674005678686e-05, 5.096308064979547e-06,
     8.493846725573018e-07, 2.5582988345150994e-07, 3.587441199892727e-08,
     4.774165235545952e-09},
    4);

// input range [0 , 1]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI_FIRST_63_8(
    {3.7470305990772723,   -4.638192807400737,   3.451647852092825,
     -2.704958996867145,   2.0636639866767483,   -1.4951639564730876,
     0.9854477497061098,   -0.4819378070571563,  1.6336716944268572,
     -2.76904121849965,    2.3549640412677393,   -1.9181073533876878,
     1.5289900212787852,   -1.1296999278467599,  0.7529443026129572,
     -0.37327618968275056, 1.1836077066361628,   -2.0772438646563556,
     1.745801597721979,    -1.4651817316975049,  1.1504393819772811,
     -0.8719417412236012,  0.5713185673260779,   -0.2894764917379563,
     1.0821349495624975,   -1.908549835765016,   1.6045894502290228,
     -1.3495703321824526,  1.061178851921683,    -0.8043625725449064,
     0.5280858833138864,   -0.26723312994626314, 0.6898369018746365,
     -1.135655700068842,   0.835170884610287,    -0.7481327875761092,
     0.587320388531819,    -0.4289252937955255,  0.30083628323462036,
     -0.140131166643924,   0.5795869039789795,   -0.958820150054684,
     0.8585692190819295,   -0.685418214411141,   0.5656685541484897,
     -0.4122061184491783,  0.28056281935342176,  -0.13762436414167079,
     0.6144843501549628,   -0.8916118971929966,  0.5360615527253657,
     -0.5152467444087678,  0.4246852625647899,   -0.2710572632900743,
     0.2285208249172932,   -0.08497095020238055, 0.710668219342288,
     -1.4416631422563424,  1.2079747601355624,   -1.254940548632019,
     1.0714362205030998,   -0.9799638072339124,  1.1123271113811286,
     -0.47178772555186504},
    8);

// input range [0, 1.238]
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI128_LAST_31_8(
    {2.74059171724613293009,  -3.09379113046313714008, 2.23804448456937521428,
     -1.68595795308999329976, 1.26089280829302885500,  -0.90334099463299832866,
     0.58431635552103544651,  -0.28721575776880792219, 0.84332718136483797444,
     -1.41703265873654049578, 1.17360244066984109601,  -0.95089773156208745597,
     0.74356137637363162174,  -0.54812798655465788666, 0.36089840443041787399,
     -0.17915464042414686041, 0.29605104517447611290,  -0.48766519073965708397,
     0.40370769111724480460,  -0.32689520485727791010, 0.25504937635601265811,
     -0.18777720172593176384, 0.12338049380150309386,  -0.06121907537465265392,
     0.14657952298544796310,  -0.23491823182254789604, 0.18827259348551872442,
     -0.14552899068688551765, 0.11285413743372814388,  -0.08230825546563683148,
     0.06060135876083823370,  -0.03947827437148588442},
    8);

// LT over [0, 1].
static HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI128_15_BSGS_GH(
    {2.794785514836915840675146682770, -2.776114159010104387448336638045,
     1.637496867049793136672519722197, -0.733334636108289639189194986102,
     1.114827747088057208202371839434, -1.632323265898276032359603959776,
     1.045544005708266777077142251073, -0.496803684324503280755891410081,
     0.555369862418463422493175585259, -0.928820945208048587282689823041,
     0.615773248799254324659102621808, -0.253641980038799397245696809478,
     0.474310189600725851111207020949, -0.564916127346382190843598891661,
     0.167910119337647267823143693022, -0.019054929050487771913235945931},
    4);

static const HEaaN::Math::ChebyshevCoefficients EXPONENTIAL_UNI_15_BSGS =
    EXPONENTIAL_UNI_15_4;
static const HEaaN::Math::ChebyshevCoefficients INVERSE_SQRT_UNI_FIRST_63_BSGS =
    INVERSE_SQRT_UNI_FIRST_63_8;
static const HEaaN::Math::ChebyshevCoefficients
    INVERSE_SQRT_UNI128_LAST_31_BSGS = INVERSE_SQRT_UNI128_LAST_31_8;

} // namespace HELLM::Softmax
