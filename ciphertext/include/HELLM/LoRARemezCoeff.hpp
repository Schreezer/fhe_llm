////////////////////////////////////////////////////////////////////////////////
//                                                                            //
// Copyright (C) 2021-2024 Crypto Lab Inc. All rights reserved.               //
//                                                                            //
// This source code is protected under international copyright law.           //
// All rights reserved and protected by the copyright holders.                //
//                                                                            //
////////////////////////////////////////////////////////////////////////////////

#pragma once

#include "HEaaN-math/tools/PolynomialEvaluator.hpp"
#include "HEaaN/HEaaN.hpp"
#include <vector>
namespace HELLM::LoRA {

// input range [0.00025*2, 1] + 3 Newton
// same coeff with LN
// near 0.0005: prec 8 bits (worst) , 18 bits (avg)
static const HEaaN::Math::ChebyshevCoefficients COLA_INVERSE_SQRT_COEFFS_127_16(
    {3.9359587065628147684037685394287109375000,
     -5.1385534462947362044360488653182983398438,
     4.2535060641399837777498760260641574859619,
     -3.6382258778900791185151319950819015502930,
     3.1679572070094366154080489650368690490723,
     -2.7778237066418398626410635188221931457520,
     2.4382166798272351115883793681859970092773,
     -2.1330843351777559746551560238003730773926,
     1.8526928674257305829087272286415100097656,
     -1.5906436040046969537797849625349044799805,
     1.3424577483493465024366741999983787536621,
     -1.1048324266816962335724383592605590820312,
     0.8752171434696549567888723686337471008301,
     -0.6515560308352519314212258905172348022461,
     0.4321211561568816250655800104141235351562,
     -0.2153978368579032576235476881265640258789,
     1.4074671664789093483705073595046997070312,
     -2.6041437986320943309692665934562683105469,
     2.4013587684083859130623750388622283935547,
     -2.2055517285780297243036329746246337890625,
     2.0158386019751333151361905038356781005859,
     -1.8314497979609996036742813885211944580078,
     1.6517078820573942721239291131496429443359,
     -1.4760100849193804606329649686813354492188,
     1.3038143980671748067834414541721343994141,
     -1.1346283588668484298978000879287719726562,
     0.9679998701287786389002576470375061035156,
     -0.8035095687166631250875070691108703613281,
     0.6407643765887769404798746109008789062500,
     -0.4793919521639509184751659631729125976562,
     0.3190358203648884227732196450233459472656,
     -0.1593510028342279838398098945617675781250,
     0.9400984998711692242068238556385040283203,
     -1.7519438704805452289292588829994201660156,
     1.6258980198417702922597527503967285156250,
     -1.5018665692487047635950148105621337890625,
     1.3796675979942847334314137697219848632812,
     -1.2591287676057163480436429381370544433594,
     1.1400861106269530864665284752845764160156,
     -1.0223829568053588445764034986495971679688,
     0.9058689742114438558928668498992919921875,
     -0.7903993064824135217349976301193237304688,
     0.6758337902729181223548948764801025390625,
     -0.5620362393519826582632958889007568359375,
     0.4488737836331893049646168947219848632812,
     -0.3362162529169836489018052816390991210938,
     0.2239355963070011057425290346145629882812,
     -0.1119053291386080672964453697204589843750,
     0.8285970861938949383329600095748901367188,
     -1.5461029735361080383881926536560058593750,
     1.4365175589828140800818800926208496093750,
     -1.3283198865165104507468640804290771484375,
     1.2213959003956915694288909435272216796875,
     -1.1156351203408121364191174507141113281250,
     1.0109302624869087594561278820037841796875,
     -0.9071768882022297475486993789672851562500,
     0.8042730771867354633286595344543457031250,
     -0.7021191215844737598672509193420410156250,
     0.6006172382312797708436846733093261718750,
     -0.4996712964057223871350288391113281250000,
     0.3991865587104257429018616676330566406250,
     -0.2990694328327663242816925048828125000000,
     0.1992272322167991660535335540771484375000,
     -0.0995679436455247923731803894042968750000,
     0.3381501901517367514315992593765258789062,
     -0.4697765963992424076423048973083496093750,
     0.5654107095181473141565220430493354797363,
     -0.5226923917711019385023973882198333740234,
     0.4804978252034857177932281047105789184570,
     -0.4387845433894312918710056692361831665039,
     0.3975106239139449826325289905071258544922,
     -0.3566346339344477200938854366540908813477,
     0.3161155782468085817527025938034057617188,
     -0.2759128495821414617239497601985931396484,
     0.2359861808483287859417032450437545776367,
     -0.1962955990593400201760232448577880859375,
     0.1568013807187185193470213562250137329102,
     -0.1174640084171869602869264781475067138672,
     0.0782441284400192671455442905426025390625,
     -0.0391025091558958592941053211688995361328,
     0.2880644613260301412083208560943603515625,
     -0.5373197219610119645949453115463256835938,
     0.4990582720508882630383595824241638183594,
     -0.4613061553263833047822117805480957031250,
     0.4240253651976217952324077486991882324219,
     -0.3871782702337895898381248116493225097656,
     0.3507275798353930440498515963554382324219,
     -0.3146363112964536412619054317474365234375,
     0.2788677580913372366921976208686828613281,
     -0.2433854592645730008371174335479736328125,
     0.2081531697917853307444602251052856445312,
     -0.1731348317866832076106220483779907226562,
     0.1382945464429212734103202819824218750000,
     -0.1035965465898698312230408191680908203125,
     0.0690051697642957151401787996292114257812,
     -0.0344848316781281027942895889282226562500,
     0.1779637883316809165989980101585388183594,
     -0.0094531028639721625950187444686889648438,
     0.2664505723101342482550535351037979125977,
     -0.2459608073738763778237625956535339355469,
     0.2257965046061372049734927713871002197266,
     -0.2059320239847011180245317518711090087891,
     0.1863418741170335124479606747627258300781,
     -0.1670006983514440435101278126239776611328,
     0.1478832612947371671907603740692138671875,
     -0.1289644356909320777049288153648376464844,
     0.1102191896192152853473089635372161865234,
     -0.0916225739747460465878248214721679687500,
     0.0731497101934337479178793728351593017578,
     -0.0547757781830569001613184809684753417969,
     0.0364760044258218840695917606353759765625,
     -0.0182256502159816591301932930946350097656,
     0.1501877795299151330254971981048583984375,
     -0.2825462020050508726853877305984497070312,
     0.2654850042931684583891183137893676757812,
     -0.2491680816660846176091581583023071289062,
     0.2335720817484343569958582520484924316406,
     -0.2186741736509247857611626386642456054688,
     0.2044520379820369271328672766685485839844,
     -0.1908838572458080307114869356155395507812,
     0.1779483065979547973256558179855346679688,
     -0.1656245449373727751662954688072204589844,
     0.1538922063114114280324429273605346679688,
     -0.1427313916126422554953023791313171386719,
     0.1321226605493848182959482073783874511719,
     -0.1220470238699817855376750230789184570312,
     0.1124859358259300279314629733562469482422,
     -0.6590982859306677710264921188354492187500},
    16);

// input range [0.01/5, 1] + 2 Newton
static const HEaaN::Math::ChebyshevCoefficients MRPC_INVERSE_SQRT_COEFFS_63_8(
    {
        2.8618268419086234644055366516113281250000000000000000000,
        -3.0886226341160636366112157702445983886718750000000000000,
        2.1857471893817965735706820851191878318786621093750000000,
        -1.6154254953348470280616311356425285339355468750000000000,
        1.1907917647119568016478297067806124687194824218750000000,
        -0.8438078706955955965440807631239295005798339843750000000,
        0.5417271321021388530425610952079296112060546875000000000,
        -0.2650619287247195643431041389703750610351562500000000000,
        0.7166934839390179945439740549772977828979492187500000000,
        -1.1881437772836420663224998861551284790039062500000000000,
        0.9729376422598079443559981882572174072265625000000000000,
        -0.7806450308211196897900663316249847412109375000000000000,
        0.6057421133080254094238625839352607727050781250000000000,
        -0.4437660947224628671392565593123435974121093750000000000,
        0.2909632396973620416247285902500152587890625000000000000,
        -0.1440439623326028595329262316226959228515625000000000000,
        0.2872372745609084176976466551423072814941406250000000000,
        -0.4853150655402203028643270954489707946777343750000000000,
        0.4035201364911813470826018601655960083007812500000000000,
        -0.3277228740829798425693297758698463439941406250000000000,
        0.2567145198175637688109418377280235290527343750000000000,
        -0.1894068800552872744447086006402969360351562500000000000,
        0.1248015486746112401306163519620895385742187500000000000,
        -0.0619638558984547671570908278226852416992187500000000000,
        0.1965266241220433585112914443016052246093750000000000000,
        -0.3336472204138090091873891651630401611328125000000000000,
        0.2785319654009299483732320368289947509765625000000000000,
        -0.2269623015874913107836619019508361816406250000000000000,
        0.1782572507413533458020538091659545898437500000000000000,
        -0.1317866159245113522047176957130432128906250000000000000,
        0.0869591345810931670712307095527648925781250000000000000,
        -0.0432117987509172962745651602745056152343750000000000000,
        0.0517915768077159555105026811361312866210937500000000000,
        -0.0625587894282944034785032272338867187500000000000000000,
        0.0708308301116105099026754032820463180541992187500000000,
        -0.0578592262908728116599377244710922241210937500000000000,
        0.0455340525751566360668221022933721542358398437500000000,
        -0.0337157888868020449990581255406141281127929687500000000,
        0.0222718280532205881172558292746543884277343750000000000,
        -0.0110746343310665906756184995174407958984375000000000000,
        0.0363061902134944602948962710797786712646484375000000000,
        -0.0619281459922831345465965569019317626953125000000000000,
        0.0519070986322276439750567078590393066406250000000000000,
        -0.0424399546570839447667822241783142089843750000000000000,
        0.0334243339680710960237774997949600219726562500000000000,
        -0.0247634479139264840341638773679733276367187500000000000,
        0.0163648776835998432943597435951232910156250000000000000,
        -0.0081394226810971304075792431831359863281250000000000000,
        0.0204360666777461119636427611112594604492187500000000000,
        0.0164626802849738851364236325025558471679687500000000000,
        0.0231685251059019492458901368081569671630859375000000000,
        -0.0189586252191134008171502500772476196289062500000000000,
        0.0149413389845989286186522804200649261474609375000000000,
        -0.0110755993189144419375224970281124114990234375000000000,
        0.0073220512238663104653824120759963989257812500000000000,
        -0.0036426039022217082674615085124969482421875000000000000,
        0.0185647955072738568560453131794929504394531250000000000,
        -0.0336684118074117577634751796722412109375000000000000000,
        0.0305351602636392271961085498332977294921875000000000000,
        -0.0276983674923769740416901186108589172363281250000000000,
        0.0251296684439523687615292146801948547363281250000000000,
        -0.0228034898822215836844407021999359130859375000000000000,
        0.0206967712829566607979359105229377746582031250000000000,
        -0.1069426536960236262530088424682617187500000000000000000,
    },
    8);

// input range [0.01/3, 1] + 2 Newton
static const HEaaN::Math::ChebyshevCoefficients RTE_INVERSE_SQRT_COEFFS_63_8(
    {2.6998337240875116549432277679443359375000000000000000000,
     -2.8066457892421272646288343821652233600616455078125000000,
     1.9307961356074296865870110195828601717948913574218750000,
     -1.4001158128007018532912297814618796110153198242187500000,
     1.0169735524995466846576164243742823600769042968750000000,
     -0.7126448483825873481123380770441144704818725585937500000,
     0.4539418241991883817831876513082534074783325195312500000,
     -0.2210732460822759648522151110228151082992553710937500000,
     0.5460612336648997811039407679345458745956420898437500000,
     -0.8907652650793629334202705649659037590026855468750000000,
     0.7191007000903937296243384480476379394531250000000000000,
     -0.5699439189409361006255494430661201477050781250000000000,
     0.4377671256876780603306542616337537765502929687500000000,
     -0.3181457545294854583062260644510388374328613281250000000,
     0.2073948040721234065131284296512603759765625000000000000,
     -0.1023145703119752170096035115420818328857421875000000000,
     0.1721032558663182499003596603870391845703125000000000000,
     -0.2864990489542478258044866379350423812866210937500000000,
     0.2351011885011686786128848325461149215698242187500000000,
     -0.1887871742901836569217266514897346496582031250000000000,
     0.1464945427030386326805455610156059265136718750000000000,
     -0.1072850605273032442710245959460735321044921875000000000,
     0.0703128200108409373569884337484836578369140625000000000,
     -0.0347973329835298272882937453687191009521484375000000000,
     0.1007946657349521046853624284267425537109375000000000000,
     -0.1687441379886536196863744407892227172851562500000000000,
     0.1391336375374407907656859606504440307617187500000000000,
     -0.1121668210286088651628233492374420166015625000000000000,
     0.0873156042837877066631335765123367309570312500000000000,
     -0.0641014089291047639562748372554779052734375000000000000,
     0.0420834391294420129270292818546295166015625000000000000,
     -0.0208482158233209702302701771259307861328125000000000000,
     0.0199282514523702047881670296192169189453125000000000000,
     -0.0300117532011405785397073486819863319396972656250000000,
     0.0272035769627754220323367917444556951522827148437500000,
     -0.0219892663589771331089650630019605159759521484375000000,
     0.0171545055404394020115432795137166976928710937500000000,
     -0.0126148921302853267434329609386622905731201171875000000,
     0.0082917783245992637830568128265440464019775390625000000,
     -0.0041107155024473485127600724808871746063232421875000000,
     0.0123146989966738118482680874876677989959716796875000000,
     -0.0207246526492426141885516699403524398803710937500000000,
     0.0171653047937070368789136409759521484375000000000000000,
     -0.0138911477816350270586553961038589477539062500000000000,
     0.0108471756101238270275644026696681976318359375000000000,
     -0.0079825587185737845175026450306177139282226562500000000,
     0.0052497083154321444453671574592590332031250000000000000,
     -0.0026034088394624177453806623816490173339843750000000000,
     0.0051676365058028750354424118995666503906250000000000000,
     -0.0017582048859807741791883017867803573608398437500000000,
     0.0062298597125458599066405440680682659149169921875000000,
     -0.0050463487656138283909967867657542228698730468750000000,
     0.0039436195040565280578448437154293060302734375000000000,
     -0.0029039256500560384210984921082854270935058593750000000,
     0.0019105945958877157409006031230092048645019531250000000,
     -0.0009477417958088096838764613494277000427246093750000000,
     0.0038064945221698565092083299532532691955566406250000000,
     -0.0067246422411457729140238370746374130249023437500000000,
     0.0059409476650884585069434251636266708374023437500000000,
     -0.0052494750553435665096912998706102371215820312500000000,
     0.0046392926972771419968921691179275512695312500000000000,
     -0.0041007846566216699102369602769613265991210937500000000,
     0.0036254908550894526797492289915680885314941406250000000,
     -0.0147161137155507049101288430392742156982421875000000000},
    8);

// input range [0.00025*2, 1] + 3 Newton
// same coeff with LN
static const HEaaN::Math::ChebyshevCoefficients RTE_INVERSE_SQRT_COEFFS_127_16(
    {3.9359587065628147684037685394287109375000,
     -5.1385534462947362044360488653182983398438,
     4.2535060641399837777498760260641574859619,
     -3.6382258778900791185151319950819015502930,
     3.1679572070094366154080489650368690490723,
     -2.7778237066418398626410635188221931457520,
     2.4382166798272351115883793681859970092773,
     -2.1330843351777559746551560238003730773926,
     1.8526928674257305829087272286415100097656,
     -1.5906436040046969537797849625349044799805,
     1.3424577483493465024366741999983787536621,
     -1.1048324266816962335724383592605590820312,
     0.8752171434696549567888723686337471008301,
     -0.6515560308352519314212258905172348022461,
     0.4321211561568816250655800104141235351562,
     -0.2153978368579032576235476881265640258789,
     1.4074671664789093483705073595046997070312,
     -2.6041437986320943309692665934562683105469,
     2.4013587684083859130623750388622283935547,
     -2.2055517285780297243036329746246337890625,
     2.0158386019751333151361905038356781005859,
     -1.8314497979609996036742813885211944580078,
     1.6517078820573942721239291131496429443359,
     -1.4760100849193804606329649686813354492188,
     1.3038143980671748067834414541721343994141,
     -1.1346283588668484298978000879287719726562,
     0.9679998701287786389002576470375061035156,
     -0.8035095687166631250875070691108703613281,
     0.6407643765887769404798746109008789062500,
     -0.4793919521639509184751659631729125976562,
     0.3190358203648884227732196450233459472656,
     -0.1593510028342279838398098945617675781250,
     0.9400984998711692242068238556385040283203,
     -1.7519438704805452289292588829994201660156,
     1.6258980198417702922597527503967285156250,
     -1.5018665692487047635950148105621337890625,
     1.3796675979942847334314137697219848632812,
     -1.2591287676057163480436429381370544433594,
     1.1400861106269530864665284752845764160156,
     -1.0223829568053588445764034986495971679688,
     0.9058689742114438558928668498992919921875,
     -0.7903993064824135217349976301193237304688,
     0.6758337902729181223548948764801025390625,
     -0.5620362393519826582632958889007568359375,
     0.4488737836331893049646168947219848632812,
     -0.3362162529169836489018052816390991210938,
     0.2239355963070011057425290346145629882812,
     -0.1119053291386080672964453697204589843750,
     0.8285970861938949383329600095748901367188,
     -1.5461029735361080383881926536560058593750,
     1.4365175589828140800818800926208496093750,
     -1.3283198865165104507468640804290771484375,
     1.2213959003956915694288909435272216796875,
     -1.1156351203408121364191174507141113281250,
     1.0109302624869087594561278820037841796875,
     -0.9071768882022297475486993789672851562500,
     0.8042730771867354633286595344543457031250,
     -0.7021191215844737598672509193420410156250,
     0.6006172382312797708436846733093261718750,
     -0.4996712964057223871350288391113281250000,
     0.3991865587104257429018616676330566406250,
     -0.2990694328327663242816925048828125000000,
     0.1992272322167991660535335540771484375000,
     -0.0995679436455247923731803894042968750000,
     0.3381501901517367514315992593765258789062,
     -0.4697765963992424076423048973083496093750,
     0.5654107095181473141565220430493354797363,
     -0.5226923917711019385023973882198333740234,
     0.4804978252034857177932281047105789184570,
     -0.4387845433894312918710056692361831665039,
     0.3975106239139449826325289905071258544922,
     -0.3566346339344477200938854366540908813477,
     0.3161155782468085817527025938034057617188,
     -0.2759128495821414617239497601985931396484,
     0.2359861808483287859417032450437545776367,
     -0.1962955990593400201760232448577880859375,
     0.1568013807187185193470213562250137329102,
     -0.1174640084171869602869264781475067138672,
     0.0782441284400192671455442905426025390625,
     -0.0391025091558958592941053211688995361328,
     0.2880644613260301412083208560943603515625,
     -0.5373197219610119645949453115463256835938,
     0.4990582720508882630383595824241638183594,
     -0.4613061553263833047822117805480957031250,
     0.4240253651976217952324077486991882324219,
     -0.3871782702337895898381248116493225097656,
     0.3507275798353930440498515963554382324219,
     -0.3146363112964536412619054317474365234375,
     0.2788677580913372366921976208686828613281,
     -0.2433854592645730008371174335479736328125,
     0.2081531697917853307444602251052856445312,
     -0.1731348317866832076106220483779907226562,
     0.1382945464429212734103202819824218750000,
     -0.1035965465898698312230408191680908203125,
     0.0690051697642957151401787996292114257812,
     -0.0344848316781281027942895889282226562500,
     0.1779637883316809165989980101585388183594,
     -0.0094531028639721625950187444686889648438,
     0.2664505723101342482550535351037979125977,
     -0.2459608073738763778237625956535339355469,
     0.2257965046061372049734927713871002197266,
     -0.2059320239847011180245317518711090087891,
     0.1863418741170335124479606747627258300781,
     -0.1670006983514440435101278126239776611328,
     0.1478832612947371671907603740692138671875,
     -0.1289644356909320777049288153648376464844,
     0.1102191896192152853473089635372161865234,
     -0.0916225739747460465878248214721679687500,
     0.0731497101934337479178793728351593017578,
     -0.0547757781830569001613184809684753417969,
     0.0364760044258218840695917606353759765625,
     -0.0182256502159816591301932930946350097656,
     0.1501877795299151330254971981048583984375,
     -0.2825462020050508726853877305984497070312,
     0.2654850042931684583891183137893676757812,
     -0.2491680816660846176091581583023071289062,
     0.2335720817484343569958582520484924316406,
     -0.2186741736509247857611626386642456054688,
     0.2044520379820369271328672766685485839844,
     -0.1908838572458080307114869356155395507812,
     0.1779483065979547973256558179855346679688,
     -0.1656245449373727751662954688072204589844,
     0.1538922063114114280324429273605346679688,
     -0.1427313916126422554953023791313171386719,
     0.1321226605493848182959482073783874511719,
     -0.1220470238699817855376750230789184570312,
     0.1124859358259300279314629733562469482422,
     -0.6590982859306677710264921188354492187500},
    16);

// input range [0.01/13, 1] + 2 Newton
static const HEaaN::Math::ChebyshevCoefficients SST2_INVERSE_SQRT_COEFFS_127_16(
    {3.1653487387338827829807996749877929687500000000000000000,
     -3.7529299214167437526157300453633069992065429687500000000,
     2.8868416677090751321088646363932639360427856445312500000,
     -2.3594947980953122623759554699063301086425781250000000000,
     1.9799594946178391552393804886378347873687744140625000000,
     -1.6828134209313700964116833347361534833908081054687500000,
     1.4380438364736818357414449565112590789794921875000000000,
     -1.2292820012180563082893058890476822853088378906250000000,
     1.0465360432612849095335150195751339197158813476562500000,
     -0.8831913924780510072309880342800170183181762695312500000,
     0.7345846459037916886813945893663913011550903320312500000,
     -0.5972520229554074688849141239188611507415771484375000000,
     0.4685002177447419313693899312056601047515869140625000000,
     -0.3461443093420513150704209692776203155517578125000000000,
     0.2283375586220444120044703595340251922607421875000000000,
     -0.1134537608780217254889066680334508419036865234375000000,
     0.5729532138074322489273981773294508457183837890625000000,
     -1.0373743288738381806979305110871791839599609375000000000,
     0.9373796422464586441947176354005932807922363281250000000,
     -0.8448114411127711775861826026812195777893066406250000000,
     0.7587138607646579657739493995904922485351562500000000000,
     -0.6782556265155257335663918638601899147033691406250000000,
     0.6027064033378337626345455646514892578125000000000000000,
     -0.5314181486262938847175973933190107345581054687500000000,
     0.4638101854755305453181790653616189956665039062500000000,
     -0.3993570747938051113123947288841009140014648437500000000,
     0.3375786120557435765476839151233434677124023437500000000,
     -0.2780314468888462897666613571345806121826171875000000000,
     0.2203019452484653584178886376321315765380859375000000000,
     -0.1640000005336972321856592316180467605590820312500000000,
     0.1087535619107597995025571435689926147460937500000000000,
     -0.0542036923492759115106309764087200164794921875000000000,
     0.1883166166163832144775369670242071151733398437500000000,
     -0.3445999798021972537753754295408725738525390625000000000,
     0.3143665799661761184324859641492366790771484375000000000,
     -0.2857577459829059307594434358179569244384765625000000000,
     0.2586113282938526936050038784742355346679687500000000000,
     -0.2327767087671190893161110579967498779296875000000000000,
     0.2081133772404086812457535415887832641601562500000000000,
     -0.1844896619936520210103481076657772064208984375000000000,
     0.1617815896089638272314914502203464508056640625000000000,
     -0.1398718535314316113726818002760410308837890625000000000,
     0.1186488737375839264132082462310791015625000000000000000,
     -0.0980059324020174926772597245872020721435546875000000000,
     0.0778403724361993454294861294329166412353515625000000000,
     -0.0580528473718402437953045591711997985839843750000000000,
     0.0385466123105970837059430778026580810546875000000000000,
     -0.0192268466458642706129467114806175231933593750000000000,
     0.1135229236388966000959044322371482849121093750000000000,
     -0.2083331044841543189249932765960693359375000000000000000,
     0.1905586928739921859232708811759948730468750000000000000,
     -0.1736382183580076343787368386983871459960937500000000000,
     0.1574922172975448120268993079662322998046875000000000000,
     -0.1420456489407229128119070082902908325195312500000000000,
     0.1272274268275168651598505675792694091796875000000000000,
     -0.1129699843300500106124673038721084594726562500000000000,
     0.0992088700098179288033861666917800903320312500000000000,
     -0.0858823689143264346057549118995666503906250000000000000,
     0.0729311463074964194674976170063018798828125000000000000,
     -0.0602979106436123402090743184089660644531250000000000000,
     0.0479270928589130562613718211650848388671875000000000000,
     -0.0357645392737140355166047811508178710937500000000000000,
     0.0237572155770067183766514062881469726562500000000000000,
     -0.0118529195133305620402097702026367187500000000000000000,
     0.0235543566457181441364809870719909667968750000000000000,
     -0.0341921999269487741912598721683025360107421875000000000,
     0.0388629214333153782945373677648603916168212890625000000,
     -0.0354695785600256385805550962686538696289062500000000000,
     0.0322195625781098726747586624696850776672363281250000000,
     -0.0290994451736192871749153709970414638519287109375000000,
     0.0260964022530458805704256519675254821777343750000000000,
     -0.0231981518686623644498467911034822463989257812500000000,
     0.0203928953766894238697204855270683765411376953125000000,
     -0.0176692614515676638120567076839506626129150390625000000,
     0.0150162526066370816124617704190313816070556640625000000,
     -0.0124231938926122609245794592425227165222167968750000000,
     0.0098796834630441310309834079816937446594238281250000000,
     -0.0073755447125734008295694366097450256347656250000000000,
     0.0049007797063893576705595478415489196777343750000000000,
     -0.0024455236304952165937720565125346183776855468750000000,
     0.0149271402306574429985630558803677558898925781250000000,
     -0.0274667824134837701421929523348808288574218750000000000,
     0.0251858541955485293328820262104272842407226562500000000,
     -0.0230024739638636788185976911336183547973632812500000000,
     0.0209080390201279442408122122287750244140625000000000000,
     -0.0188943276231228196593292523175477981567382812500000000,
     0.0169534627489156264346092939376831054687500000000000000,
     -0.0150778776042983508887118659913539886474609375000000000,
     0.0132602827089414176953141577541828155517578125000000000,
     -0.0114936343732523482685792259871959686279296875000000000,
     0.0097711044077612996261450462043285369873046875000000000,
     -0.0080860509072806507901987060904502868652343750000000000,
     0.0064319899617828468763036653399467468261718750000000000,
     -0.0048025681500263317502685822546482086181640625000000000,
     0.0031915356784111281740479171276092529296875000000000000,
     -0.0015927200309704403480282053351402282714843750000000000,
     0.0065794602448505656866473145782947540283203125000000000,
     0.0061182401951214160362724214792251586914062500000000000,
     0.0094730885471854264778812648728489875793457031250000000,
     -0.0086567622916788877773797139525413513183593750000000000,
     0.0078726799873507502525171730667352676391601562500000000,
     -0.0071178906877769065886241151019930839538574218750000000,
     0.0063895605440507097227964550256729125976562500000000000,
     -0.0056849612929426029950263909995555877685546875000000000,
     0.0050014592194180806927761295810341835021972656250000000,
     -0.0043365045425112214161345036700367927551269531250000000,
     0.0036876211759029331460624234750866889953613281250000000,
     -0.0030523968168765236441686283797025680541992187500000000,
     0.0024284733187371898566198069602251052856445312500000000,
     -0.0018135373035192969837225973606109619140625000000000000,
     0.0012053109730345568095799535512924194335937500000000000,
     -0.0006015430772308150153548922389745712280273437500000000,
     0.0050297615018379815410298760980367660522460937500000000,
     -0.0094761566171115418910630978643894195556640625000000000,
     0.0089269880456157579828868620097637176513671875000000000,
     -0.0084099917173574567641480825841426849365234375000000000,
     0.0079232640824073996554943732917308807373046875000000000,
     -0.0074650161427030070626642554998397827148437500000000000,
     0.0070335664520584373349265661090612411499023437500000000,
     -0.0066273345558371943297970574349164962768554687500000000,
     0.0062448348421284549658594187349081039428710937500000000,
     -0.0058846707778457130189053714275360107421875000000000000,
     0.0055455295053263853333191946148872375488281250000000000,
     -0.0052261767763539523912186268717050552368164062500000000,
     0.0049254522021868751835427246987819671630859375000000000,
     -0.0046422647996848809270886704325675964355468750000000000,
     0.0043755888147174459845700766891241073608398437500000000,
     -0.0370104178699648400652222335338592529296875000000000000},
    16);

// input range [0.005, 1] + 2 Newton
static const HEaaN::Math::ChebyshevCoefficients STSB_INVERSE_SQRT_COEFFS_63_8(
    {2.5714711778418859466910362243652343750000000000000000000,
     -2.5737805606297952110139704018365591764450073242187500000,
     1.7255766517399837578494725676137022674083709716796875000,
     -1.2267771076833158261365497310180217027664184570312500000,
     0.8771542955356990134418992965947836637496948242187500000,
     -0.6072568812419307793248890448012389242649078369140625000,
     0.3834804934853013325124493348994292318820953369140625000,
     -0.1857904280009208264345943462103605270385742187500000000,
     0.4184952980468623628951263526687398552894592285156250000,
     -0.6704289775261802475370132015086710453033447265625000000,
     0.5325399187570969417038213578052818775177001953125000000,
     -0.4161756238315605926914031442720443010330200195312500000,
     0.3159039175709850155726599041372537612915039062500000000,
     -0.2274372265456596764465757587458938360214233398437500000,
     0.1472563336222396657149147358722984790802001953125000000,
     -0.0723466267663113171693112235516309738159179687500000000,
     0.1042701863356603197985350561793893575668334960937500000,
     -0.1706405483534378930698949261568486690521240234375000000,
     0.1379048157799172003024068544618785381317138671875000000,
     -0.1092744745650335858044854830950498580932617187500000000,
     0.0838533168181250232464662985876202583312988281250000000,
     -0.0608680290741787644037685822695493698120117187500000000,
     0.0396361473369672978606104152277112007141113281250000000,
     -0.0195392962702278794040466891601681709289550781250000000,
     0.0514110987271081398830574471503496170043945312500000000,
     -0.0846765595170353435605647973716259002685546875000000000,
     0.0688056009357893572087050415575504302978515625000000000,
     -0.0547685808205358171107945963740348815917968750000000000,
     0.0421817649650790826854063197970390319824218750000000000,
     -0.0307058717936570246820338070392608642578125000000000000,
     0.0200352876701401783066103234887123107910156250000000000,
     -0.0098885910469164173264289274811744689941406250000000000,
     0.0078611519936373497330350801348686218261718750000000000,
     -0.0124926749399687508912393241189420223236083984375000000,
     0.0105151872282056579877007607137784361839294433593750000,
     -0.0083937048404665315359807209460996091365814208984375000,
     0.0064797018748288248701783231808803975582122802734375000,
     -0.0047253932138322518596851296024397015571594238281250000,
     0.0030872737930711657838855899171903729438781738281250000,
     -0.0015249389665967783002997748553752899169921875000000000,
     0.0041483523790164511524380941409617662429809570312500000,
     -0.0068716188630055796693341108039021492004394531250000000,
     0.0056114106606663938237034017220139503479003906250000000,
     -0.0044854673214675955250640981830656528472900390625000000,
     0.0034665921685501643878524191677570343017578125000000000,
     -0.0025303013627802073415296035818755626678466796875000000,
     0.0016541963624412403532915050163865089416503906250000000,
     -0.0008173942631941599756828509271144866943359375000000000,
     0.0013414699609644031852440093643963336944580078125000000,
     -0.0012146152737955162592697888612747192382812500000000000,
     0.0016551224843217582360921369399875402450561523437500000,
     -0.0013244247549013543618912081001326441764831542968750000,
     0.0010244821427849437611712346551939845085144042968750000,
     -0.0007482970543017941622565558645874261856079101562500000,
     0.0004894461790110327115144173149019479751586914062500000,
     -0.0002419244907443385272927116602659225463867187500000000,
     0.0008017403990177029982078238390386104583740234375000000,
     -0.0013798329763901051592256408184766769409179687500000000,
     0.0011875718062324125412487774156033992767333984375000000,
     -0.0010222674856752433925066725350916385650634765625000000,
     0.0008801211034290545853764342609792947769165039062500000,
     -0.0007578741003415601085180242080241441726684570312500000,
     0.0006527309063262265453886357136070728302001953125000000,
     -0.0021816982927091999044932890683412551879882812500000000},
    8);

static const HEaaN::Math::ChebyshevCoefficients COLA_INVERSE_SQRT_127 =
    COLA_INVERSE_SQRT_COEFFS_127_16;

static const HEaaN::Math::ChebyshevCoefficients MRPC_INVERSE_SQRT_63 =
    MRPC_INVERSE_SQRT_COEFFS_63_8;

static const HEaaN::Math::ChebyshevCoefficients RTE_INVERSE_SQRT_63 =
    RTE_INVERSE_SQRT_COEFFS_63_8;

static const HEaaN::Math::ChebyshevCoefficients RTE_INVERSE_SQRT_127 =
    RTE_INVERSE_SQRT_COEFFS_127_16;

static const HEaaN::Math::ChebyshevCoefficients SST2_INVERSE_SQRT_127 =
    SST2_INVERSE_SQRT_COEFFS_127_16;

static const HEaaN::Math::ChebyshevCoefficients STSB_INVERSE_SQRT_63 =
    STSB_INVERSE_SQRT_COEFFS_63_8;

} // namespace HELLM::LoRA
