////////////////////////////////////////////////////////////////////////////////
//                                                                            //
// Copyright (C) 2021-2024 Crypto Lab Inc. All rights reserved.               //
//                                                                            //
// This source code is protected under international copyright law.           //
// All rights reserved and protected by the copyright holders.                //
//                                                                            //
////////////////////////////////////////////////////////////////////////////////

#pragma once

#include "HEaaN-math/tools/PolynomialEvaluator.hpp"
#include "HEaaN/HEaaN.hpp"
#include <vector>
namespace HELLM::Loss {

// input range [-2, 2]
static const HEaaN::Math::ChebyshevCoefficients
    EXP_15_4({2.2795853023344534449279308319091796875000000000000000000,
              3.1808305193593966464504774194210767745971679687500000000,
              1.3746971520387094578552478196797892451286315917968750000,
              0.4058286139324818742046829811442876234650611877441406250,
              0.1014571354501081767995884774791193194687366485595703125,
              0.0393026084044210063939139843114389805123209953308105469,
              0.0063994866685381495557960462861046835314482450485229492,
              0.0008863798243944620569578773938701488077640533447265625,
              0.0000553987390246590827302952675381675362586975097656250,
              0.0000121767403431454263913616756220825720902212196961045,
              0.0000012067365124407632469223693519322360145906714024022,
              0.0000001081982869352056945326870374124439422303112223744,
              0.0000000090165239110433833408242421114664466585963964462,
              0.0000000013796130076531036481174430363694227708037942648,
              0.0000000000980785986734873695678561811295281813727342524,
              0.0000000000065353935470404213923091649857122220623750763},
             4);

// input range [-13, 1]
static const HEaaN::Math::ChebyshevCoefficients
    EXP_SST2_15_4({0.4179025176927098073065280914306640625000000000000000000,
                   0.7507765823639102054087857140984851866960525512695312500,
                   0.5534326064443626513877916295314207673072814941406250000,
                   0.2892717178979251624326707315049134194850921630859375000,
                   0.2527641684846391179064539755927398800849914550781250000,
                   0.2659281458307658496664771519135683774948120117187500000,
                   0.1226975649181731853332166792824864387512207031250000000,
                   0.0455733756193552608237951062619686126708984375000000000,
                   0.0099691759167228610749589279294013977050781250000000000,
                   0.0068993164529979125743075485388544620946049690246582031,
                   0.0021805731419464041698219602949393447488546371459960938,
                   0.0005975737922337409635531457752222195267677307128906250,
                   0.0001742922841136973488573858048766851425170898437500000,
                   0.0000882240295067004964835177815984934568405151367187500,
                   0.0000208919932571938193888172463630326092243194580078125,
                   0.0000048480786529608854706907550280448049306869506835938},
                  4);

static const HEaaN::Math::ChebyshevCoefficients INV_63_8(
    {
        5.0000000000000000000000000000000000000000000000000000000,
        -6.6539603316099533714123026584275066852569580078125000000,
        4.4169140520210339317941361514385789632797241210937500000,
        -2.9160201143674546742090569750871509313583374023437500000,
        1.9011295291078762481618014135165140032768249511718750000,
        -1.2030938653679137395613452099496498703956604003906250000,
        0.7055738458543410196455170080298557877540588378906250000,
        -0.3256494673181233867609307708335109055042266845703125000,
        0.3895912941861217060335320638841949403285980224609375000,
        -0.5184650034183975186863335693487897515296936035156250000,
        0.3441582523686812500329779140884056687355041503906250000,
        -0.2272112100468464956914971253354451619088649749755859375,
        0.1481327027329805423594422109090373851358890533447265625,
        -0.0937429792077019152785055666754487901926040649414062500,
        0.0549770855503120131624328337238694075495004653930664062,
        -0.0253740394847615756412917420448138727806508541107177734,
        0.0152243531160752409298053677844109188299626111984252930,
        -0.0202604483420888818734351133343807305209338665008544922,
        0.0134489318423421395226613483941946469713002443313598633,
        -0.0088789039829976785372922520878091745544224977493286133,
        0.0057886934541387337002649182693403417943045496940612793,
        -0.0036632651676513222627207255754910875111818313598632812,
        0.0021483810757635989421854283420998399378731846809387207,
        -0.0009915604965075718729705656073747377377003431320190430,
        0.0011862550867341396104714945636260381434112787246704102,
        -0.0015786588580836563577847186934377532452344894409179688,
        0.0010479173523805229706340469419956207275390625000000000,
        -0.0006918287387414207012525935169833246618509292602539062,
        0.0004510449148913409089800552465021610260009765625000000,
        -0.0002854352435237850205140830439631827175617218017578125,
        0.0001673981127432999649329303792910650372505187988281250,
        -0.0000772606674198650367202390043530613183975219726562500,
        0.0000231782002259872665916873302194289863109588623046875,
        -0.0000308451645439043539037062002794442605591029860079288,
        0.0000204751761979514179136657031632395842279947828501463,
        -0.0000135175882834182791933114869964427384729788172990084,
        0.0000088129317494571112969912671242234125656977994367480,
        -0.0000055770971737175327801166319074965826985135208815336,
        0.0000032707787936137411533227617455032998350361594930291,
        -0.0000015095902124344427568114479498717628302983939647675,
        0.0000018060008186042203134902273120587778976187109947205,
        -0.0000024034115612077454685047150917398539604619145393372,
        0.0000015953900787382051078278077937966372701339423656464,
        -0.0000010532669427287908326534848768574192945379763841629,
        0.0000006866882971718485124262842944631302088964730501175,
        -0.0000004345577011444375602200462793689439422450959682465,
        0.0000002548533886412079549343978612796490779146552085876,
        -0.0000001176246409113684485148176861457613995298743247986,
        0.0000000705747845467993850654409015987766906619071960449,
        -0.0000000935195054460568250538458900944505103325354866683,
        0.0000000622496357502447863205632949679113607999170199037,
        -0.0000000410968354425247112278983541155952252665883861482,
        0.0000000267935077085961652950535372141871448548045009375,
        -0.0000000169557645927418516006157656050845616846345365047,
        0.0000000099439822423591950773663628027065897185821086168,
        -0.0000000045895302657047651329058624014578526839613914490,
        0.0000000055074363188457181594870348817494232207536697388,
        -0.0000000073432484251276242126493798423325642943382263184,
        0.0000000048954989500873415629589313624592250562272965908,
        -0.0000000032636659667248943753059542416394833708181977272,
        0.0000000021757773111476708290112913601888067205436527729,
        -0.0000000014505182074334746185687028408040077920304611325,
        0.0000000009670121382889830790458018938693385280203074217,
        -0.0000000011604145659457632553182571122363242466235533357,
    },
    8);

// [0.8,3.0]
static const HEaaN::Math::ChebyshevCoefficients INV_SST2_15_4(
    {
        0.6454972243682277621701359748840332031250000000000000000,
        -0.4113285260888217553798540393472649157047271728515625000,
        0.1299586742998130317605642858325154520571231842041015625,
        -0.0376196162447090393099458083270292263478040695190429688,
        0.0133529888673684926647666770804789848625659942626953125,
        -0.0085088907516845529999116592989594209939241409301757812,
        0.0026883721346964706278015455609420314431190490722656250,
        -0.0007782129863589393181655395892448723316192626953125000,
        0.0001381419387320725888912420487031340599060058593750000,
        -0.0000880079172004876245094528997015004279091954231262207,
        0.0000278092944946033496234072401875891955569386482238770,
        -0.0000080500589326520585742308355747809400781989097595215,
        0.0000028579598833622377185292862122878432273864746093750,
        -0.0000018228933916942385851100993932050187140703201293945,
        0.0000005813483136742764179061282447946723550558090209961,
        -0.0000002063922975772264356564278386940713971853256225586,
    },
    4);

static const HEaaN::Math::ChebyshevCoefficients EXP_COEFFS_15 = EXP_15_4;
static const HEaaN::Math::ChebyshevCoefficients EXP_COEFFS_15_SST2 =
    EXP_SST2_15_4;
static const HEaaN::Math::ChebyshevCoefficients INV_COEFFS_63 = INV_63_8;
static const HEaaN::Math::ChebyshevCoefficients INV_COEFFS_15_SST2 =
    INV_SST2_15_4;

} // namespace HELLM::Loss
